
<!DOCTYPE html>
<html>
<head>
    <title>Satellite Attitude Control</title>
    <style>
        body { font-family: sans-serif; background: #000; color: #fff; display: flex; flex-direction: column; align-items: center; }
        canvas { border: 1px solid #444; }
    </style>
</head>
<body>
    <h1>Satellite Control (PD)</h1>
    <p>Target: Stationary aligned with axes.</p>
    <canvas id="simCanvas" width="600" height="600"></canvas>
    <script>
        const history = [[0.7035251259803772, 0.7105956673622131, -0.00883825495839119, -0.005302952602505684], [0.6998926401138306, 0.7087438702583313, -0.07659547030925751, -0.04433538764715195], [0.7271963953971863, 0.6732801198959351, -0.11554203182458878, -0.0673016607761383], [0.7634398937225342, 0.6263312697410583, -0.13573747873306274, -0.08027464151382446], [0.7997815608978271, 0.5763511657714844, -0.14400382339954376, -0.0862073078751564], [0.8329946398735046, 0.5268358588218689, -0.14480073750019073, -0.08715815097093582], [0.8620948195457458, 0.47930601239204407, -0.14101862907409668, -0.08468876779079437], [0.8869931101799011, 0.4344547688961029, -0.13452358543872833, -0.07997399568557739], [0.9079631567001343, 0.3926040232181549, -0.12651625275611877, -0.07388270646333694], [0.9254197478294373, 0.3538840711116791, -0.11776570975780487, -0.06704966723918915], [0.9398182034492493, 0.3183088004589081, -0.1087624579668045, -0.05993356183171272], [0.9516057968139648, 0.2858121991157532, -0.09981793910264969, -0.052860867232084274], [0.9611966013908386, 0.25627201795578003, -0.09112861007452011, -0.046058040112257004], [0.9689605236053467, 0.22952726483345032, -0.08281717449426651, -0.03967545926570892], [0.9752190709114075, 0.20539292693138123, -0.0749581977725029, -0.0338054783642292], [0.9802467226982117, 0.18367184698581696, -0.06759440153837204, -0.028496533632278442], [0.9842740893363953, 0.16416363418102264, -0.060746654868125916, -0.02376425452530384], [0.9874926209449768, 0.14667174220085144, -0.0544205978512764, -0.019600428640842438], [0.9900599122047424, 0.13100752234458923, -0.0486106239259243, -0.015980077907443047], [0.992104709148407, 0.11699346452951431, -0.043302953243255615, -0.012867125682532787], [0.9937314987182617, 0.10446461290121078, -0.03847771883010864, -0.01021883450448513], [0.9950244426727295, 0.09326943010091782, -0.03411070629954338, -0.007989189587533474], [0.9960513114929199, 0.08326960355043411, -0.030174709856510162, -0.006131424568593502], [0.9968665242195129, 0.07433976978063583, -0.026640640571713448, -0.004599847365170717], [0.997513473033905, 0.06636682897806168, -0.02347852662205696, -0.0033510976936668158], [0.9980267882347107, 0.059248946607112885, -0.020658256486058235, -0.002344947773963213], [0.9984339475631714, 0.052894797176122665, -0.018150193616747856, -0.0015447607729583979], [0.9987570643424988, 0.04722260311245918, -0.015925679355859756, -0.0009176902240142226], [0.999013364315033, 0.04215920343995094, -0.013957376591861248, -0.0004346825589891523], [0.9992167353630066, 0.037639208137989044, -0.012219542637467384, -7.034918235149235e-05], [0.9993781447410583, 0.03360423073172569, -0.010688172653317451, 0.0001972533209482208], [0.9995061755180359, 0.030002152547240257, -0.009341076947748661, 0.00038689604843966663], [0.9996078014373779, 0.026786448433995247, -0.008157909847795963, 0.0005144794122315943], [0.9996885061264038, 0.023915622383356094, -0.0071201506070792675, 0.0005933443317189813], [0.9997525811195374, 0.021352631971240044, -0.006211027968674898, 0.0006345774163492024], [0.999803364276886, 0.019064420834183693, -0.005415446124970913, 0.0006473034736700356], [0.9998438358306885, 0.017021507024765015, -0.004719874355942011, 0.0006389570771716535], [0.9998759031295776, 0.015197557397186756, -0.004112233407795429, 0.0006155305891297758], [0.9999013543128967, 0.013569089584052563, -0.0035817809402942657, 0.000581797503400594], [0.9999216198921204, 0.012115143239498138, -0.003118992317467928, 0.0005415108753368258], [0.9999377131462097, 0.01081700250506401, -0.0027154460549354553, 0.0004975759657099843], [0.9999505281448364, 0.009657965041697025, -0.0023637141566723585, 0.00045220120227895677], [0.9999606013298035, 0.008623121306300163, -0.002057258039712906, 0.00040702763362787664], [0.9999687671661377, 0.007699164561927319, -0.001790334121324122, 0.00036323911626823246], [0.9999751448631287, 0.00687420554459095, -0.0015579035971313715, 0.00032165448646992445], [0.9999802708625793, 0.006137639284133911, -0.0013555529294535518, 0.0002828057040460408], [0.9999842643737793, 0.005479993764311075, -0.001179420854896307, 0.00024700220092199743], [0.9999874830245972, 0.004892812576144934, -0.0010261323768645525, 0.00021438344265334308], [0.9999900460243225, 0.004368545953184366, -0.0008927402086555958, 0.00018496235134080052], [0.9999921321868896, 0.003900453681126237, -0.0007766722701489925, 0.00015865992463659495], [0.9999937415122986, 0.003482515225186944, -0.000675685703754425, 0.0001353327970718965], [0.9999949932098389, 0.0031093584839254618, -0.0005878256051801145, 0.00011479525710456073], [0.9999960660934448, 0.002776184817776084, -0.0005113885272294283, 9.68360182014294e-05], [0.9999968409538269, 0.0024787113070487976, -0.0004448913678061217, 8.123135194182396e-05], [0.9999974966049194, 0.0022131111472845078, -0.00038704235339537263, 6.775462679797783e-05], [0.9999979734420776, 0.0019759698770940304, -0.00033671731944195926, 5.6183500419138e-05], [0.9999984502792358, 0.001764238579198718, -0.00029293785337358713, 4.630492549040355e-05], [0.9999987483024597, 0.0015751944156363606, -0.00025485255173407495, 3.7918453017482534e-05], [0.9999989867210388, 0.0014064074493944645, -0.0002217207511421293, 3.08382986986544e-05], [0.9999992251396179, 0.0012557065347209573, -0.00019289791816845536, 2.489437065378297e-05], [0.9999994039535522, 0.0011211533565074205, -0.0001678233966231346, 1.9932685972889885e-05], [0.9999995231628418, 0.0010010177502408624, -0.0001460095081711188, 1.5815117876627482e-05], [0.9999996423721313, 0.0008937549428083003, -0.00012703206448350102, 1.2418811820680276e-05], [0.9999997019767761, 0.0007979856454767287, -0.00011052203626604751, 9.635325113777071e-06], [0.9999997615814209, 0.0007124784169718623, -9.615847375243902e-05, 7.369611921603791e-06], [0.9999998211860657, 0.0006361334817484021, -8.366216934518889e-05, 5.538915502256714e-06], [0.9999998807907104, 0.0005679692840203643, -7.27902734070085e-05, 4.071627245139098e-06], [0.9999998807907104, 0.0005071090417914093, -6.333155033644289e-05, 2.9061525310680736e-06], [0.9999999403953552, 0.0004527701821643859, -5.510222399607301e-05, 1.9898197933798656e-06], [0.9999999403953552, 0.00040425389306619763, -4.794243068317883e-05, 1.2778400559909642e-06], [0.9999999403953552, 0.0003609364212024957, -4.171313048573211e-05, 7.323423574234766e-07], [0.9999999403953552, 0.00032226054463535547, -3.629335333243944e-05, 3.2148440709534043e-07], [1.0, 0.0002877289371099323, -3.1577874324284494e-05, 1.864549581398478e-08], [1.0, 0.0002568975614849478, -2.7475134629639797e-05, -1.9829981567909272e-07], [1.0, 0.00022936990717425942, -2.390549889241811e-05, -3.476297649740445e-07], [1.0, 0.00020479194063227624, -2.0799679987248965e-05, -4.4434855794861505e-07], [1.0, 0.00018284757970832288, -1.809740388125647e-05, -5.006901346860104e-07], [1.0, 0.00016325463366229087, -1.5746230928925797e-05, -5.265573008728097e-07], [1.0, 0.00014576119428966194, -1.3700536328542512e-05, -5.29902649759606e-07], [1.0, 0.0001301422598771751, -1.1920625183847733e-05, -5.17056605531252e-07], [1.0, 0.00011619694123510271, -1.0371959433541633e-05, -4.93008656121674e-07], [1.0, 0.0001037459442159161, -9.02449664863525e-06, -4.6164629452505324e-07], [1.0, 9.262912499252707e-05, -7.852094313420821e-06, -4.259581771748344e-07], [1.0, 8.270351099781692e-05, -6.8320055106596556e-06, -3.88204512091761e-07], [1.0, 7.384147465927526e-05, -5.944441909377929e-06, -3.500599348171818e-07], [1.0, 6.592903810087591e-05, -5.1721858653763775e-06, -3.12732566953855e-07], [1.0, 5.886445433134213e-05, -4.500256181927398e-06, -2.770624121239962e-07], [1.0, 5.255687938188203e-05, -3.915619799954584e-06, -2.4360201678064186e-07], [1.0, 4.692518268711865e-05, -3.4069350931531517e-06, -2.1268296279686183e-07], [1.0, 4.189694664091803e-05, -2.9643347261298914e-06, -1.844691297492318e-07], [1.0, 3.740751344594173e-05, -2.579233296273742e-06, -1.5899986749445816e-07], [1.0, 3.339913746458478e-05, -2.2441618057200685e-06, -1.362244148594982e-07], [1.0, 2.9820272175129503e-05, -1.952619413714274e-06, -1.1602909921748505e-07], [1.0, 2.6624898964655586e-05, -1.698952019069111e-06, -9.82584680286891e-08], [1.0, 2.3771925043547526e-05, -1.4782391417611507e-06, -8.273173079942353e-08], [1.0, 2.1224657757556997e-05, -1.2861991081081214e-06, -6.92551864744928e-08], [1.0, 1.8950344383483753e-05, -1.1191073099325877e-06, -5.763146404547115e-08], [1.0, 1.691973375272937e-05, -9.737226491779438e-07, -4.766619809970507e-08], [1.0, 1.510671336291125e-05, -8.472250669910864e-07, -3.917282143106604e-08], [1.0, 1.348796286038123e-05, -7.371609171968885e-07, -3.197566300627841e-08], [1.0, 1.2042670277878642e-05, -6.413953315131948e-07, -2.5911916168297466e-08], [1.0, 1.0752246453193948e-05, -5.580707806984719e-07, -2.0832617408927945e-08], [1.0, 9.600095836503897e-06, -4.855710358242504e-07, -1.6603001640191906e-08], [1.0, 8.571404578106012e-06, -4.224898475513328e-07, -1.3102315676860599e-08], [1.0, 7.652942258573603e-06, -3.6760351918019296e-07, -1.0223297763900518e-08], [1.0, 6.832895905972691e-06, -3.1984760084924346e-07, -7.871408413961944e-09], [1.0, 6.100720838730922e-06, -2.7829577220472856e-07, -5.963920468587958e-09], [1.0, 5.447001967695542e-06, -2.42141993567202e-07, -4.428927002919636e-09], [1.0, 4.863332378590712e-06, -2.1068495925646857e-07, -3.2043228070932628e-09], [1.0, 4.342205102148e-06, -1.833145688578952e-07, -2.236792751020289e-09], [1.0, 3.876919436152093e-06, -1.5949989062846726e-07, -1.480837341638619e-09], [1.0, 3.4614909054653253e-06, -1.3877900073566707e-07, -8.97852459047499e-10], [1.0, 3.090576910835807e-06, -1.2075000199729402e-07, -4.552712373762091e-10], [1.0, 2.759408289421117e-06, -1.0506319370051642e-07, -1.257787762831697e-10], [1.0, 2.4637256501591764e-06, -9.141427881331765e-08, 1.1340074712595793e-10], [1.0, 2.1997266230755486e-06, -7.95385091123535e-08, 2.8114402472745326e-10], [1.0, 1.964016519195866e-06, -6.920553374811789e-08, 3.9299805076886685e-10], [1.0, 1.7535635379317682e-06, -6.021492993113498e-08, 4.6168288636572186e-10], [1.0, 1.5656613641112926e-06, -5.2392319815908195e-08, 4.975320155864438e-10], [1.0, 1.3978939250591793e-06, -4.558595279036126e-08, 5.088762744520636e-10], [1.0, 1.2481035582823097e-06, -3.966381356690363e-08, 5.023751969979173e-10], [1.0, 1.114363840315491e-06, -3.451102514873128e-08, 4.833026201467305e-10], [1.0, 9.949546893039951e-07, -3.00276425946322e-08, 4.5578954499525537e-10], [1.0, 8.883409350346483e-07, -2.6126707908247226e-08, 4.230321648535096e-10], [1.0, 7.931512868708523e-07, -2.2732546511861074e-08, 3.874659759706134e-10], [1.0, 7.081617354742775e-07, -1.9779324844648727e-08, 3.5091288208555227e-10], [1.0, 6.322791250568116e-07, -1.7209762503966886e-08, 3.1470373529352003e-10], [1.0, 5.645277383337088e-07, -1.497401491690198e-08, 2.797802267640037e-10], [1.0, 5.040361088504142e-07, -1.3028718548468987e-08, 2.4677865306799163e-10], [1.0, 4.500264196849457e-07, -1.1336137362150112e-08, 2.1609879163886347e-10], [1.0, 4.0180407268053386e-07, -9.863442507196396e-09, 1.8795963396822657e-10], [1.0, 3.5874899140253547e-07, -8.582067501095025e-09, 1.6244494638328888e-10], [1.0, 3.203074641078274e-07, -7.467157558949111e-09, 1.3953917188391785e-10], [1.0, 2.859851235825772e-07, -6.497087756685005e-09, 1.1915636533021967e-10], [1.0, 2.553405522576213e-07, -5.65304025812452e-09, 1.01162529742016e-10], [1.0, 2.2797969734256185e-07, -4.918644602724953e-09, 8.539335905055623e-11], [1.0, 2.03550669652941e-07, -4.279655740901944e-09, 7.16674566914044e-11], [1.0, 1.8173935245613393e-07, -3.7236780325855534e-09, 5.979649414511456e-11], [1.0, 1.6226518084749841e-07, -3.239929213805226e-09, 4.959253840919331e-11], [1.0, 1.448777595669526e-07, -2.8190247913784106e-09, 4.087338453806488e-11], [1.0, 1.2935346660469804e-07, -2.4528012954050382e-09, 3.3466132642878677e-11], [1.0, 1.1549267497912297e-07, -2.1341539646613228e-09, 2.7209489869561843e-11], [1.0, 1.0311713083410723e-07, -1.8569028537029908e-09, 2.1955116544236652e-11], [1.0, 9.206767970226792e-08, -1.6156695981095481e-09, 1.7568170876391953e-11], [1.0, 8.220222724730775e-08, -1.4057752739660145e-09, 1.3927344520714424e-11], [1.0, 7.339389895832937e-08, -1.2231486934410896e-09, 1.0924484407370816e-11], [1.0, 6.552942011239793e-08, -1.0642474679301017e-09, 8.463956098492265e-12], [1.0, 5.8507655609219e-08, -9.259892852497842e-10, 6.461808085139742e-12], [1.0, 5.223830967793219e-08, -8.056925682176086e-10, 4.844861924840904e-12], [1.0, 4.664074992888345e-08, -7.010237945692666e-10, 3.5497384111987662e-12]];
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const cx = canvas.width / 2;
        const cy = canvas.height / 2;
        const scale = 150; 
        
        // Satellite Geometry (Box + Solar Panels)
        const body_verts = [
            [-0.5,-0.5,0.5], [0.5,-0.5,0.5], [0.5,0.5,0.5], [-0.5,0.5,0.5], // Front
            [-0.5,-0.5,-0.5], [0.5,-0.5,-0.5], [0.5,0.5,-0.5], [-0.5,0.5,-0.5] // Back
        ];
        
        const panel_left = [ [-1.5, -0.2, 0], [-0.5, -0.2, 0], [-0.5, 0.2, 0], [-1.5, 0.2, 0] ];
        const panel_right = [ [0.5, -0.2, 0], [1.5, -0.2, 0], [1.5, 0.2, 0], [0.5, 0.2, 0] ];
        
        let frame = 0;
        
        function rotateByQuat(v, q) {
            const [w, x, y, z] = q;
            const [vx, vy, vz] = v;
            const x2 = x + x, y2 = y + y, z2 = z + z;
            const xx = x * x2, xy = x * y2, xz = x * z2;
            const yy = y * y2, yz = y * z2, zz = z * z2;
            const wx = w * x2, wy = w * y2, wz = w * z2;
            return [
                (1 - (yy + zz)) * vx + (xy - wz) * vy + (xz + wy) * vz,
                (xy + wz) * vx + (1 - (xx + zz)) * vy + (yz - wx) * vz,
                (xz - wy) * vx + (yz + wx) * vy + (1 - (xx + yy)) * vz
            ];
        }
        
        function drawPoly(pts, q, fillStyle, strokeStyle) {
            ctx.beginPath();
            let first = true;
            for(let v of pts) {
                const r = rotateByQuat(v, q);
                const x = cx + r[0]*scale;
                const y = cy - r[1]*scale;
                if(first) { ctx.moveTo(x,y); first=false; }
                else ctx.lineTo(x,y);
            }
            ctx.closePath();
            ctx.fillStyle = fillStyle;
            ctx.fill();
            ctx.strokeStyle = strokeStyle;
            ctx.stroke();
        }
        
        function draw() {
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.fillRect(0,0, canvas.width, canvas.height);
            
            const q = history[frame];
            
            // Draw Target Frame (Ghost) - Faint
            // Identity quaternion is [1,0,0,0] -> No rotation.
            // Just raw projection.
            // drawAxes([1,0,0,0], 0.2); 
            
            // Draw Satellite
            // We need proper depth sorting or just simple wireframe.
            // Simple painter's alg is hard without Z-sort.
            // Let's just draw wireframe panels and body.
            
            drawPoly(panel_left, q, 'rgba(0,0,255,0.5)', '#0af');
            drawPoly(panel_right, q, 'rgba(0,0,255,0.5)', '#0af');
            
            // Body edges manually
            const r_verts = body_verts.map(v => rotateByQuat(v, q));
            const proj = r_verts.map(v => [cx + v[0]*scale, cy - v[1]*scale]);
            
            ctx.strokeStyle = '#ddd';
            const edges = [[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];
            ctx.beginPath();
            for(let e of edges) {
                ctx.moveTo(proj[e[0]][0], proj[e[0]][1]);
                ctx.lineTo(proj[e[1]][0], proj[e[1]][1]);
            }
            ctx.stroke();
            
            // Draw Axis Arrows
            const axes = [[1,0,0], [0,1,0], [0,0,1]];
            const colors = ['#f00', '#0f0', '#00f'];
            for(let i=0; i<3; i++) {
                const r = rotateByQuat(axes[i], q);
                ctx.strokeStyle = colors[i];
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(cx, cy);
                ctx.lineTo(cx + r[0]*scale, cy - r[1]*scale);
                ctx.stroke();
            }

            frame = (frame + 1);
            if(frame >= history.length) frame = history.length - 1; // Hold at end
            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>
</html>
    
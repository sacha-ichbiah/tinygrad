
<!DOCTYPE html>
<html>
<head>
    <title>Harmonic Oscillator (yoshida4)</title>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; alignItems: center; justify-content: center; height: 100vh; margin: 0; background: #111; color: #eee; }
        canvas { background: #222; border: 1px solid #444; }
        .controls { margin-top: 10px; }
        button { padding: 8px 16px; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Harmonic Oscillator (yoshida4)</h1>
    <canvas id="simCanvas" width="600" height="400"></canvas>
    <div class="controls">
        <button onclick="toggleAnimation()">Pause/Play</button>
        <button onclick="resetAnimation()">Reset</button>
    </div>
    <p>Step: <span id="stepDisplay">0</span> | q: <span id="qDisplay">0.00</span> | p: <span id="pDisplay">0.00</span></p>

    <script>
        const qData = [1.0, 0.9950042366981506, 0.9800668954849243, 0.9553371667861938, 0.9210621118545532, 0.8775842189788818, 0.8253379464149475, 0.7648452520370483, 0.6967105865478516, 0.6216146945953369, 0.5403079986572266, 0.45360273122787476, 0.3623652756214142, 0.2675072252750397, 0.1699763834476471, 0.07074719667434692, -0.029188871383666992, -0.12883327901363373, -0.22719047963619232, -0.32327768206596375, -0.4161348342895508, -0.5048341751098633, -0.5884894728660583, -0.6662647724151611, -0.7373831272125244, -0.8011338114738464, -0.8568800091743469, -0.9040646553039551, -0.9422162771224976, -0.9709537029266357, -0.9899898171424866, -0.9991344213485718, -0.9982961416244507, -0.9874833226203918, -0.966804027557373, -0.9364649057388306, -0.8967690467834473, -0.8481131196022034, -0.790983259677887, -0.7259502410888672, -0.6536638736724854, -0.5748463869094849, -0.4902852773666382, -0.40082547068595886, -0.30736082792282104, -0.2108251452445984, -0.11218298971652985, -0.01241995394229889, 0.08746716380119324, 0.1864803582429886, 0.2836303114891052, 0.3779463768005371, 0.4684861898422241, 0.5543450713157654, 0.6346652507781982, 0.7086440920829773, 0.7755425572395325, 0.834692120552063, 0.8855018019676208, 0.9274640083312988, 0.960159420967102, 0.9832613468170166, 0.9965389370918274, 0.999859631061554, 0.9931901693344116, 0.976597249507904, 0.9502465724945068, 0.9144014716148376, 0.869420051574707, 0.815751850605011, 0.7539330124855042, 0.6845812797546387, 0.6083894968032837, 0.5261189341545105, 0.43859168887138367, 0.34668219089508057, 0.2513088285923004, 0.1534244865179062, 0.05400720238685608, -0.045949697494506836, -0.1454474776983261, -0.2434920072555542, -0.33910369873046875, -0.431327223777771, -0.5192410945892334, -0.6019669771194458, -0.6786782741546631, -0.7486084699630737, -0.8110589981079102, -0.8654057383537292, -0.9111058115959167, -0.9477025270462036, -0.9748302698135376, -0.9922178983688354, -0.9996917247772217, -0.9971771240234375, -0.9846991896629333, -0.9623825550079346, -0.9304502606391907, -0.8892213106155396, -0.8391077518463135];
        const pData = [0.0, -0.09983313828706741, -0.19866880774497986, -0.29551947116851807, -0.389417439699173, -0.47942450642585754, -0.5646414160728455, -0.6442167162895203, -0.7173552513122559, -0.7833263278007507, -0.8414707183837891, -0.8912076354026794, -0.9320399761199951, -0.9635598063468933, -0.9854521751403809, -0.9974983334541321, -0.999578058719635, -0.9916703104972839, -0.9738543033599854, -0.9463080167770386, -0.9093067049980164, -0.8632199764251709, -0.8085083365440369, -0.7457184791564941, -0.6754777431488037, -0.5984879732131958, -0.515518307685852, -0.42739784717559814, -0.33500704169273376, -0.23926898837089539, -0.14114029705524445, -0.04160139709711075, 0.05835316330194473, 0.15772467851638794, 0.2555202841758728, 0.35076284408569336, 0.4425007700920105, 0.5298174023628235, 0.6118403673171997, 0.6877501010894775, 0.7567881345748901, 0.8182647228240967, 0.871565580368042, 0.916158139705658, 0.9515969157218933, 0.9775277376174927, 0.993691623210907, 0.9999269843101501, 0.9961714744567871, 0.9824627041816711, 0.9589375853538513, 0.9258311986923218, 0.8834744095802307, 0.8322903513908386, 0.7727904319763184, 0.7055691480636597, 0.6312981247901917, 0.5507194995880127, 0.46463829278945923, 0.3739146292209625, 0.2794550061225891, 0.18220317363739014, 0.0831308662891388, -0.016772054135799408, -0.1165073961019516, -0.21507865190505981, -0.3115009665489197, -0.4048108756542206, -0.49407607316970825, -0.5784047245979309, -0.6569541692733765, -0.7289397120475769, -0.7936420440673828, -0.8504146337509155, -0.8986902832984924, -0.9379866123199463, -0.9679110646247864, -0.9881645441055298, -0.9985447525978088, -0.9989479184150696, -0.9893700480461121, -0.9699069261550903, -0.9407529830932617, -0.9021994471549988, -0.8546314835548401, -0.7985244989395142, -0.7344390153884888, -0.6630153656005859, -0.5849671363830566, -0.5010741949081421, -0.4121747612953186, -0.31915706396102905, -0.22295048832893372, -0.1245163157582283, -0.02483803778886795, 0.07508841156959534, 0.17426460981369019, 0.2716996371746063, 0.3664199709892273, 0.45747920870780945, 0.5439674854278564];
        const dt = 0.1;
        
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;
        const centerX = width / 2;
        const centerY = height / 2;
        const scale = 100; // Pixels per unit
        
        let frame = 0;
        let running = true;
        let animationId;

        function draw() {
            ctx.clearRect(0, 0, width, height);

            // Draw axis
            ctx.strokeStyle = '#444';
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(width, centerY);
            ctx.stroke();

            // Draw Spring
            const x = qData[frame] * scale;
            ctx.strokeStyle = '#888';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            // Simple zig-zag for spring
            const segments = 10;
            const springWidth = 10;
            for(let i=0; i<=segments; i++) {
                const xPos = centerX + (x / segments) * i;
                const offset = (i%2 === 0 ? -1 : 1) * springWidth * (i>0 && i<segments ? 1 : 0);
                ctx.lineTo(xPos, centerY + offset);
            }
            ctx.stroke();

            // Draw Mass
            ctx.fillStyle = '#00ccff';
            ctx.beginPath();
            ctx.arc(centerX + x, centerY, 15, 0, Math.PI * 2);
            ctx.fill();

            // Update Stats
            document.getElementById('stepDisplay').innerText = frame;
            document.getElementById('qDisplay').innerText = qData[frame].toFixed(4);
            document.getElementById('pDisplay').innerText = pData[frame].toFixed(4);

            if (running) {
                frame++;
                if (frame >= qData.length) frame = 0;
                animationId = setTimeout(() => requestAnimationFrame(draw), 20); // Slow down slightly
            }
        }

        function toggleAnimation() {
            running = !running;
            if (running) draw();
        }

        function resetAnimation() {
            frame = 0;
            if (!running) {
                running = true;
                draw();
            }
        }

        draw();
    </script>
</body>
</html>
        

<!DOCTYPE html>
<html>
<head>
    <title>Heavy Top Precession</title>
    <style>
        body { font-family: sans-serif; background: #000; color: #fff; display: flex; flex-direction: column; align-items: center; }
        canvas { border: 1px solid #444; }
    </style>
</head>
<body>
    <h1>Heavy Top Precession</h1>
    <p>Trace of the Top's Tip (Green) and CM (Red) projected on ground.</p>
    <canvas id="simCanvas" width="600" height="600"></canvas>
    <script>
        const history = [[0.9655502438545227, 0.25901341438293457, -0.006202648393809795, 0.0242118202149868], [0.9285302758216858, 0.2531895935535431, -0.06600330024957657, 0.2633819580078125], [0.8337597250938416, 0.23161479830741882, -0.12053829431533813, 0.48648712038993835], [0.6873120069503784, 0.19511550664901733, -0.16971832513809204, 0.6787692904472351], [0.49771615862846375, 0.14831587672233582, -0.2121269851922989, 0.8278183341026306], [0.2762710154056549, 0.09583975374698639, -0.24336937069892883, 0.924802839756012], [0.03712986782193184, 0.039281103760004044, -0.25908413529396057, 0.9643410444259644], [-0.20392858982086182, -0.021166672930121422, -0.258735328912735, 0.9439391493797302], [-0.43153509497642517, -0.08282390236854553, -0.24519169330596924, 0.8641751408576965], [-0.6320295333862305, -0.13982363045215607, -0.22071832418441772, 0.7295693159103394], [-0.7934970259666443, -0.18677115440368652, -0.18478983640670776, 0.5489368438720703], [-0.9056556820869446, -0.22208689153194427, -0.13661859929561615, 0.3343658149242401], [-0.960727870464325, -0.24675273895263672, -0.07889097183942795, 0.09945554286241531], [-0.9548999071121216, -0.2603227496147156, -0.017543131485581398, -0.14174047112464905], [-0.8890243768692017, -0.2597118020057678, 0.04229610040783882, -0.37469518184661865], [-0.767943263053894, -0.2424994856119156, 0.09896032512187958, -0.5845202207565308], [-0.5992658138275146, -0.2103499323129654, 0.15217016637325287, -0.757283091545105], [-0.39285561442375183, -0.16793295741081238, 0.199247345328331, -0.8819090127944946], [-0.1611464023590088, -0.11874319612979889, 0.23492984473705292, -0.9511780738830566], [0.08094728738069534, -0.06332913786172867, 0.25525227189064026, -0.9613965153694153], [0.3174680173397064, -0.0021441131830215454, 0.2604559063911438, -0.9117960929870605], [0.5334538817405701, 0.061013560742139816, 0.2531394362449646, -0.8047513365745544], [0.7160434722900391, 0.11980769038200378, 0.23421905934810638, -0.6465827822685242], [0.8543708920478821, 0.16956771910190582, 0.20217105746269226, -0.44768717885017395], [0.9394918084144592, 0.20948536694049835, 0.15654878318309784, -0.22127665579319], [0.9653151631355286, 0.24007265269756317, 0.10095580667257309, 0.01843162067234516], [0.9299639463424683, 0.25948911905288696, 0.0413522906601429, 0.25714269280433655], [0.836226224899292, 0.26384490728378296, -0.01819019205868244, 0.48039621114730835], [0.6906511187553406, 0.2512001395225525, -0.076791912317276, 0.673797070980072], [0.5022643208503723, 0.22394603490829468, -0.13360926508903503, 0.824455738067627], [0.28212255239486694, 0.18637213110923767, -0.18469324707984924, 0.9228004217147827], [0.043617960065603256, 0.14065861701965332, -0.2243146300315857, 0.9633252620697021], [-0.19779886305332184, 0.08658938854932785, -0.24920237064361572, 0.9440741539001465], [-0.42624160647392273, 0.025217613205313683, -0.2601912021636963, 0.8660153746604919], [-0.6273821592330933, -0.0386308990418911, -0.2592041492462158, 0.7332888245582581], [-0.7893419861793518, -0.09858590364456177, -0.24573200941085815, 0.5539276003837585], [-0.9024608731269836, -0.1509312391281128, -0.21760520339012146, 0.33975300192832947], [-0.9592676162719727, -0.19537965953350067, -0.17501352727413177, 0.1048935204744339], [-0.9554552435874939, -0.23160970211029053, -0.12230059504508972, -0.13603247702121735], [-0.8911147713661194, -0.2564234733581543, -0.06501339375972748, -0.3686933219432831], [-0.770925760269165, -0.2655331790447235, -0.006025381851941347, -0.5789035558700562], [-0.6030381917953491, -0.2577202618122101, 0.05425957962870598, -0.752981424331665], [-0.397756427526474, -0.23585641384124756, 0.11412524431943893, -0.8792821168899536], [-0.167172372341156, -0.20344290137290955, 0.1684960573911667, -0.9498807787895203], [0.07455530017614365, -0.1613108515739441, 0.21161210536956787, -0.9610621929168701], [0.31167566776275635, -0.10884330421686172, 0.24106809496879578, -0.9126322269439697], [0.5286223292350769, -0.04793864116072655, 0.2579914629459381, -0.8072798252105713], [0.7119157910346985, 0.015784794464707375, 0.26327741146087646, -0.6508545875549316], [0.8508287072181702, 0.0763573870062828, 0.25506991147994995, -0.45298922061920166], [0.9370459914207458, 0.13110406696796417, 0.23095719516277313, -0.2267492115497589], [0.964685320854187, 0.1799161285161972, 0.19194331765174866, 0.013043530285358429], [0.9312939643859863, 0.22135956585407257, 0.1428079456090927, 0.2515895366668701], [0.8389329314231873, 0.25106677412986755, 0.08828482776880264, 0.4747239649295807], [0.6940994262695312, 0.2647756338119507, 0.030061393976211548, 0.6687421798706055], [0.5064139366149902, 0.2620930075645447, -0.031560324132442474, 0.8208873271942139], [0.28730303049087524, 0.24602143466472626, -0.0937940925359726, 0.9209413528442383], [0.0497230626642704, 0.21893835067749023, -0.1507188081741333, 0.9627446532249451], [-0.19160526990890503, 0.18044418096542358, -0.19696055352687836, 0.9444224834442139], [-0.42087364196777344, 0.12991534173488617, -0.2310032695531845, 0.8675395846366882], [-0.6230790615081787, 0.07020990550518036, -0.25389182567596436, 0.7364658117294312], [-0.7857905030250549, 0.007388460915535688, -0.2652437090873718, 0.5586808919906616], [-0.899583101272583, -0.053358905017375946, -0.262079119682312, 0.3452789783477783], [-0.9576074481010437, -0.11033303290605545, -0.2421436309814453, 0.11036752164363861], [-0.955662190914154, -0.1632184088230133, -0.20728859305381775, -0.1307705044746399], [-0.8931920528411865, -0.20931515097618103, -0.16233864426612854, -0.36337485909461975], [-0.7741995453834534, -0.2434006631374359, -0.1109032854437828, -0.573647677898407], [-0.606897234916687, -0.26162275671958923, -0.05364343151450157, -0.7485663890838623], [-0.40222281217575073, -0.2643677294254303, 0.008857770822942257, -0.8764975666999817], [-0.1725548803806305, -0.2543637454509735, 0.07268825173377991, -0.9488099217414856], [0.06846830248832703, -0.23264513909816742, 0.13146451115608215, -0.9611999988555908], [0.30577918887138367, -0.19783520698547363, 0.18054182827472687, -0.9136547446250916], [0.5237582325935364, -0.1496727615594864, 0.21916860342025757, -0.8094692826271057], [0.7081994414329529, -0.09194006770849228, 0.2479100078344345, -0.6546306014060974], [0.8479021191596985, -0.030718639492988586, 0.26499292254447937, -0.458145409822464], [0.9348755478858948, 0.0298559982329607, 0.2666514217853546, -0.2324080467224121], [0.9638362526893616, 0.08885613828897476, 0.2511288523674011, 0.007651534862816334], [0.9323315024375916, 0.14538724720478058, 0.22100740671157837, 0.2465285062789917], [0.8417181968688965, 0.1954793632030487, 0.18072861433029175, 0.4697183072566986], [0.697882890701294, 0.23345643281936646, 0.13259528577327728, 0.6639848947525024], [0.5106231570243835, 0.25617051124572754, 0.07652405649423599, 0.817180871963501], [0.29202142357826233, 0.26459842920303345, 0.013715474866330624, 0.918979287147522], [0.05522628873586655, 0.2607879340648651, -0.05088946968317032, 0.9624707698822021], [-0.18563400208950043, 0.2443569153547287, -0.11088156700134277, 0.945269763469696], [-0.41536813974380493, 0.2133040726184845, -0.16257180273532867, 0.869218647480011], [-0.6187902092933655, 0.16802145540714264, -0.20571932196617126, 0.7392882108688354], [-0.7827107310295105, 0.11303248256444931, -0.24004727602005005, 0.5629962086677551], [-0.8973217010498047, 0.05400093272328377, -0.2624327540397644, 0.3507515788078308], [-0.9561771750450134, -0.00612966762855649, -0.26873070001602173, 0.11606601625680923], [-0.9556376934051514, -0.06689076870679855, -0.2579176425933838, -0.12554235756397247], [-0.8950405716896057, -0.12650372087955475, -0.2330542355775833, -0.358587384223938], [-0.7776421904563904, -0.17987722158432007, -0.19779084622859955, -0.5690302848815918], [-0.6111252903938293, -0.2213180959224701, -0.1530916839838028, -0.7443836331367493], [-0.4067171812057495, -0.2485489845275879, -0.0984928160905838, -0.873557984828949], [-0.17745628952980042, -0.2628324031829834, -0.03605245426297188, -0.9476965069770813], [0.06292948871850967, -0.2651844322681427, 0.028499474748969078, -0.9617196917533875], [0.30002111196517944, -0.25388821959495544, 0.08916252851486206, -0.9151929020881653], [0.5187315940856934, -0.22672022879123688, 0.14328588545322418, -0.8117786645889282], [0.7045480012893677, -0.18489715456962585, 0.1907946616411209, -0.6580445766448975], [0.8454997539520264, -0.13337478041648865, 0.23029392957687378, -0.4629318118095398], [0.9333109259605408, -0.07699956744909286, 0.25750184059143066, -0.23810605704784393], [0.9631692171096802, -0.017538269981741905, 0.2683159112930298, 0.002005698624998331], [0.9331327676773071, 0.04462563619017601, 0.2625437080860138, 0.24154183268547058], [0.844346284866333, 0.10663660615682602, 0.24337080121040344, 0.4652726948261261], [0.7019227743148804, 0.16256678104400635, 0.21332138776779175, 0.6598260998725891], [0.515225350856781, 0.20712041854858398, 0.1721421331167221, 0.8136405348777771], [0.29673275351524353, 0.23890897631645203, 0.11938102543354034, 0.9168535470962524], [0.06023850291967392, 0.25910255312919617, 0.0580623522400856, 0.96221923828125], [-0.18014678359031677, 0.2674378454685211, -0.0056492919102311134, 0.9465686082839966], [-0.4099181592464447, 0.2610880732536316, -0.06653927266597748, 0.8714198470115662], [-0.6143227219581604, 0.2380044162273407, -0.12292566150426865, 0.7421931028366089], [-0.7797495722770691, 0.2002546191215515, -0.1745135486125946, 0.5669511556625366], [-0.8956288695335388, 0.15283186733722687, -0.21864019334316254, 0.3559320867061615], [-0.9553320407867432, 0.09945598989725113, -0.25018176436424255, 0.1218937337398529], [-0.9557461142539978, 0.040879350155591965, -0.2654589116573334, -0.12004070729017258], [-0.8966569900512695, -0.022218365222215652, -0.26505807042121887, -0.3539164364337921], [-0.7810056805610657, -0.0858539342880249, -0.25188127160072327, -0.5649911761283875], [-0.6156923770904541, -0.1436484009027481, -0.22711007297039032, -0.7407490015029907], [-0.41161757707595825, -0.19104351103305817, -0.1895284652709961, -0.870719313621521], [-0.18231360614299774, -0.22740918397903442, -0.13906168937683105, -0.9464188814163208], [0.0578811950981617, -0.2534250020980835, -0.07965859770774841, -0.9623304605484009], [0.2946736216545105, -0.2674383223056793, -0.017494557425379753, -0.9172447919845581], [0.5136810541152954, -0.265851229429245, 0.04327361658215523, -0.8146056532859802], [0.7007116079330444, -0.24712485074996948, 0.10172480344772339, -0.6615017056465149], [0.8432714343070984, -0.21405532956123352, 0.15697310864925385, -0.46736815571784973], [0.9323496222496033, -0.171242818236351, 0.20508751273155212, -0.24359619617462158], [0.963056206703186, -0.12110081315040588, 0.2405043989419937, -0.003853462403640151], [0.9340181350708008, -0.06365129351615906, 0.2602570056915283, 0.2362731248140335], [0.8467540144920349, -0.00020316368318162858, 0.2655158042907715, 0.4609868824481964], [0.7059653401374817, 0.0642346516251564, 0.25849220156669617, 0.6562535166740417], [0.5202416181564331, 0.12326953560113907, 0.23895405232906342, 0.8105888962745667], [0.30185240507125854, 0.17330247163772583, 0.20507560670375824, 0.9147651791572571], [0.06516961753368378, 0.214203879237175, 0.1574452966451645, 0.9618110060691833], [-0.17513838410377502, 0.2458011358976364, 0.10074767470359802, 0.948028564453125], [-0.4047977328300476, 0.26509585976600647, 0.04072941467165947, 0.8741876482963562], [-0.6097565293312073, 0.26812517642974854, -0.0196441151201725, 0.7456004023551941], [-0.776605486869812, 0.2540900707244873, -0.07989795506000519, 0.5709100961685181], [-0.8941642642021179, 0.22625641524791718, -0.13825254142284393, 0.360783189535141], [-0.9551140069961548, 0.18842296302318573, -0.1896611750125885, 0.12760382890701294], [-0.9563680291175842, 0.1416682004928589, -0.22855576872825623, -0.11424819380044937], [-0.898309051990509, 0.08564744889736176, -0.2528423070907593, -0.3489641547203064], [-0.7841691970825195, 0.022534770891070366, -0.2639656960964203, -0.5611531138420105], [-0.6203474402427673, -0.04187972843647003, -0.2630959153175354, -0.7376961708068848], [-0.4169989228248596, -0.10162324458360672, -0.2486712634563446, -0.868301272392273], [-0.187571719288826, -0.15413334965705872, -0.21865728497505188, -0.9451184272766113], [0.0529487170279026, -0.1994328796863556, -0.17447081208229065, -0.9627994298934937], [0.28978124260902405, -0.23622269928455353, -0.12121859937906265, -0.9195280075073242], [0.5088717937469482, -0.26035207509994507, -0.06382004916667938, -0.8180422782897949], [0.6967064738273621, -0.2679128348827362, -0.0040683019906282425, -0.6654368042945862], [0.8408691883087158, -0.2589365541934967, 0.05763288214802742, -0.4717724919319153], [0.9316682815551758, -0.23680083453655243, 0.11842106282711029, -0.24878905713558197], [0.9635828137397766, -0.20416946709156036, 0.17242147028446198, -0.009690187871456146], [0.93536776304245, -0.1609095185995102, 0.21447336673736572, 0.23064324259757996], [0.8491528630256653, -0.10670098662376404, 0.24336755275726318, 0.45642808079719543], [0.7098378539085388, -0.044685982167720795, 0.26044151186943054, 0.6529192328453064], [0.5254330635070801, 0.018921583890914917, 0.2655780017375946, 0.8081030249595642], [0.30751001834869385, 0.07894310355186462, 0.25611260533332825, 0.9130234718322754], [0.07048498094081879, 0.13377821445465088, 0.23019590973854065, 0.9613246321678162], [-0.17027662694454193, 0.1832149773836136, 0.19009347259998322, 0.9493695497512817], [-0.4000968337059021, 0.22468064725399017, 0.14093534648418427, 0.8772560954093933], [-0.6053394675254822, 0.25319093465805054, 0.08650697767734528, 0.7496498227119446], [-0.7732303738594055, 0.26526814699172974, 0.02759505808353424, 0.5753138661384583], [-0.8925427198410034, 0.2617160379886627, -0.03508725017309189, 0.36556941270828247], [-0.9552246332168579, 0.24561278522014618, -0.09754814207553864, 0.13305865228176117], [-0.9576309323310852, 0.2182723730802536, -0.15347176790237427, -0.10838160663843155], [-0.9003700017929077, 0.17860767245292664, -0.19844037294387817, -0.3435908257961273], [-0.7872831225395203, 0.12668544054031372, -0.23199310898780823, -0.5570593476295471], [-0.6248707175254822, 0.0665690079331398, -0.2549605965614319, -0.7349150776863098], [-0.42264196276664734, 0.004470482934266329, -0.26583048701286316, -0.8664224743843079], [-0.19341327250003815, -0.05549376457929611, -0.26117539405822754, -0.9440863132476807], [0.04765736684203148, -0.11247304081916809, -0.23966187238693237, -0.9631410241127014], [0.2850618362426758, -0.16564951837062836, -0.204274520277977, -0.9217222332954407], [0.5044370293617249, -0.21117977797985077, -0.15973518788814545, -0.821846067905426], [0.692757785320282, -0.24364809691905975, -0.10851883888244629, -0.6700341701507568], [0.838182806968689, -0.26029160618782043, -0.050692375749349594, -0.47657957673072815], [0.9308537840843201, -0.2624848186969757, 0.012391074560582638, -0.2538883090019226], [0.964482307434082, -0.25259846448898315, 0.07571645081043243, -0.015322357416152954], [0.937348484992981, -0.23052853345870972, 0.13296404480934143, 0.22484424710273743], [0.8518980145454407, -0.19458717107772827, 0.18067552149295807, 0.45139992237091064], [0.7136253118515015, -0.1455097794532776, 0.21887542307376862, 0.64935302734375], [0.53053879737854, -0.08808673173189163, 0.24752545356750488, 0.805915892124176], [0.3135133385658264, -0.028089068830013275, 0.26376503705978394, 0.9117831587791443], [0.07641708105802536, 0.03155802562832832, 0.26380881667137146, 0.9610251188278198], [-0.16508835554122925, 0.09043542295694351, 0.24706314504146576, 0.9505403637886047], [-0.39558887481689453, 0.1468185931444168, 0.21696837246418, 0.880271852016449], [-0.601241409778595, 0.1957489550113678, 0.17742958664894104, 0.7541285157203674], [-0.7698180675506592, 0.23181302845478058, 0.12958626449108124, 0.5803881287574768], [-0.8905921578407288, 0.25311675667762756, 0.07315047830343246, 0.3707107901573181], [-0.9552308320999146, 0.26129087805747986, 0.010347613133490086, 0.13839823007583618], [-0.959304928779602, 0.25764814019203186, -0.053032033145427704, -0.1026594415307045], [-0.9030401110649109, 0.2407538741827011, -0.11109659075737, -0.33795496821403503], [-0.7906772494316101, 0.2087196409702301, -0.16141849756240845, -0.5524579286575317], [-0.6292802095413208, 0.1631091833114624, -0.20415587723255157, -0.7319303750991821], [-0.4282526671886444, 0.10912260413169861, -0.23812897503376007, -0.8648621439933777], [-0.19968008995056152, 0.05169292166829109, -0.2593243718147278, -0.9435074925422668], [0.04172829911112785, -0.0074217310175299644, -0.26401612162590027, -0.9635865688323975], [0.28005310893058777, -0.06785712391138077, -0.2524348199367523, -0.9237111210823059], [0.5002069473266602, -0.12679556012153625, -0.2281142771244049, -0.8256389498710632], [0.6890631914138794, -0.17845317721366882, -0.19381111860275269, -0.6751173734664917], [0.8353673815727234, -0.2178274542093277, -0.1494564265012741, -0.48205316066741943], [0.9296748638153076, -0.24389824271202087, -0.09479816257953644, -0.259290486574173], [0.9653106927871704, -0.2581675946712494, -0.03303266316652298, -0.020825201645493507], [0.9397716522216797, -0.26064634323120117, 0.02963430993258953, 0.2191222608089447], [0.8552201986312866, -0.24879825115203857, 0.08810964226722717, 0.44602081179618835], [0.7176234126091003, -0.22092528641223907, 0.14091628789901733, 0.6452528834342957], [0.5355091691017151, -0.17943435907363892, 0.18795670568943024, 0.8035580515861511], [0.3195430636405945, -0.12953391671180725, 0.22676482796669006, 0.9108737111091614], [0.08284703642129898, -0.075015589594841, 0.2524946630001068, 0.9611219763755798], [-0.15925443172454834, -0.01664060167968273, 0.2618519067764282, 0.9517324566841125], [-0.39083293080329895, 0.044901043176651, 0.2558262348175049, 0.8830551505088806], [-0.5973525047302246, 0.10565546900033951, 0.23763155937194824, 0.7586422562599182], [-0.7665887475013733, 0.15940137207508087, 0.20866407454013824, 0.5859965682029724], [-0.8884251117706299, 0.20187810063362122, 0.16790644824504852, 0.37650156021118164], [-0.9548471570014954, 0.23279717564582825, 0.11550276726484299, 0.14398473501205444], [-0.9609441757202148, 0.2531304955482483, 0.055568765848875046, -0.09707321226596832], [-0.9061762690544128, 0.26148223876953125, -0.0057006655260920525, -0.33232375979423523], [-0.7946048378944397, 0.25455519556999207, -0.0642746239900589, -0.5474243760108948], [-0.6338292360305786, 0.23116901516914368, -0.11940902471542358, -0.7283973693847656], [-0.4337143301963806, 0.19443866610527039, -0.17037928104400635, -0.8631665110588074], [-0.20603646337985992, 0.1491488367319107, -0.2134391963481903, -0.9432642459869385], [0.03523733839392662, 0.09777718037366867, -0.2433122843503952, -0.9643635153770447], [0.27440348267555237, 0.04037810489535332, -0.25741472840309143, -0.9256402850151062], [0.4957723915576935, -0.021703554317355156, -0.25728875398635864, -0.8291809558868408], [0.6855739951133728, -0.08348728716373444, -0.24541933834552765, -0.6802847981452942], [0.832658588886261, -0.13875111937522888, -0.22177797555923462, -0.48810073733329773], [0.9281973838806152, -0.18418686091899872, -0.18475380539894104, -0.26531293988227844], [0.9657331705093384, -0.21996966004371643, -0.13516537845134735, -0.026517678052186966], [0.9421985149383545, -0.24617981910705566, -0.07784974575042725, 0.21353426575660706], [0.8590229749679565, -0.2600640058517456, -0.018552394583821297, 0.4405701458454132], [0.7221019268035889, -0.2579697370529175, 0.03988150879740715, 0.6406480669975281], [0.5405483245849609, -0.2394525706768036, 0.09711901843547821, 0.8006483912467957], [0.32541847229003906, -0.2080678939819336, 0.15150901675224304, 0.90986567735672], [0.0894317552447319, -0.16776899993419647, 0.1981833428144455, 0.961550235748291], [-0.15280506014823914, -0.11969924718141556, 0.23186740279197693, 0.953184187412262], [-0.38545289635658264, -0.06357315927743912, 0.2508358359336853, 0.8857007622718811], [-0.593303382396698, -0.001619864720851183, 0.25686439871788025, 0.7628952860832214], [-0.7635529041290283, 0.06040443852543831, 0.25136029720306396, 0.5917399525642395], [-0.8862842917442322, 0.1167064979672432, 0.23296086490154266, 0.38289546966552734], [-0.9540892243385315, 0.16499610245227814, 0.1998618096113205, 0.15015095472335815], [-0.962171196937561, 0.20555664598941803, 0.15371178090572357, -0.09135456383228302], [-0.9093554019927979, 0.23730561137199402, 0.09974848479032516, -0.32681652903556824], [-0.7990183234214783, 0.2563309371471405, 0.04287370666861534, -0.5422415733337402], [-0.6387965083122253, 0.25903961062431335, -0.015223641879856586, -0.7242966294288635], [-0.43917617201805115, 0.2458028495311737, -0.07424287497997284, -0.8609257936477661], [-0.21224194765090942, 0.22025084495544434, -0.1314224898815155, -0.9429587125778198], [0.028525279834866524, 0.1851760447025299, -0.1810643970966339, -0.9654593467712402], [0.26809582114219666, 0.1405191570520401, -0.21830140054225922, -0.9277518391609192], [0.490741491317749, 0.08604587614536285, -0.24226605892181396, -0.8325119018554688], [0.6819677352905273, 0.024964645504951477, -0.2545797526836395, -0.6851903796195984], [0.8301227688789368, -0.03655429556965828, -0.25533050298690796, -0.49433422088623047], [0.9266632199287415, -0.09351365268230438, -0.24205376207828522, -0.2719569504261017], [0.9657135605812073, -0.14455512166023254, -0.2131413370370865, -0.032739583402872086], [0.9442158341407776, -0.18967916071414948, -0.17108170688152313, 0.20786850154399872], [0.862907886505127, -0.22649864852428436, -0.12111060321331024, 0.43522483110427856], [0.7270618081092834, -0.25026458501815796, -0.06698630750179291, 0.6358156800270081], [0.5459365248680115, -0.25781285762786865, -0.009416719898581505, 0.7971180081367493], [0.3312298059463501, -0.25025948882102966, 0.05094875767827034, 0.9083287715911865], [0.09587845951318741, -0.2308947592973709, 0.110198475420475, 0.961951732635498], [-0.14606842398643494, -0.20114226639270782, 0.16219337284564972, 0.9549340605735779], [-0.3793836534023285, -0.16000327467918396, 0.20280025899410248, 0.8884475231170654], [-0.5886942744255066, -0.10765362530946732, 0.23186151683330536, 0.7668702006340027], [-0.7604401707649231, -0.048225704580545425, 0.250442236661911, 0.5972300171852112], [-0.8842881917953491, 0.012122990563511848, 0.25720977783203125, 0.38952600955963135], [-0.9531911611557007, 0.0694497674703598, 0.24894031882286072, 0.1569460779428482], [-0.9628971815109253, 0.1231057420372963, 0.22454610466957092, -0.0851646438241005], [-0.9121367931365967, 0.17243707180023193, 0.18721599876880646, -0.3212819993495941], [-0.8035520315170288, 0.21376143395900726, 0.14175133407115936, -0.5371375679969788], [-0.6442311406135559, 0.24189603328704834, 0.09059946238994598, -0.7198918461799622], [-0.44491130113601685, 0.2543798089027405, 0.03378085047006607, -0.8580231070518494], [-0.2183239609003067, 0.2528623938560486, -0.027378518134355545, -0.9421494007110596], [0.021931007504463196, 0.23988565802574158, -0.08792983740568161, -0.9665620923042297], [0.2614382803440094, 0.21544434130191803, -0.14172931015491486, -0.9301325082778931], [0.4850030541419983, 0.17795763909816742, -0.1855834573507309, -0.835860013961792], [0.6778469085693359, 0.12828679382801056, -0.21977195143699646, -0.6897581815719604], [0.8275477886199951, 0.07128652185201645, -0.24444268643856049, -0.50033038854599], [0.925239086151123, 0.012664423324167728, -0.2568959593772888, -0.2788846492767334], [0.9654715061187744, -0.04480965808033943, -0.2535545527935028, -0.03958470746874809], [0.9456828832626343, -0.10087088495492935, -0.23406539857387543, 0.20179776847362518], [0.8664149641990662, -0.15391334891319275, -0.20204657316207886, 0.42989876866340637], [0.7321771383285522, -0.1991211175918579, -0.1614590287208557, 0.6310295462608337], [0.5517664551734924, -0.2313089370727539, -0.11342388391494751, 0.7932116985321045], [0.3372330069541931, -0.2488621473312378, -0.05764341726899147, 0.906100869178772], [0.10214769840240479, -0.2536410391330719, 0.0036532485391944647, 0.9618829488754272], [-0.1394234299659729, -0.24709250032901764, 0.06473390012979507, 0.9567213654518127], [-0.3729075789451599, -0.22787737846374512, 0.11987752467393875, 0.8914264440536499], [-0.5833735466003418, -0.19423343241214752, 0.16689012944698334, 0.7707764506340027], [-0.7568661570549011, -0.1478593945503235, 0.2061307281255722, 0.6023297905921936], [-0.8822872042655945, -0.09400894492864609, 0.23656144738197327, 0.3959420919418335], [-0.9523627758026123, -0.03754810988903046, 0.25431743264198303, 0.16406649351119995], [-0.9633205533027649, 0.019891254603862762, 0.25588226318359375, -0.07837054133415222], [-0.9143286347389221, 0.07804760336875916, 0.24171245098114014, -0.31541508436203003], [-0.8077351450920105, 0.13418225944042206, 0.21548737585544586, -0.5320942401885986], [-0.6498518586158752, 0.1826404631137848, 0.18000157177448273, -0.7154959440231323], [-0.45105236768722534, 0.21863768994808197, 0.13518604636192322, -0.854677677154541], [-0.2245130091905594, 0.24139948189258575, 0.08081632852554321, -0.940632164478302], [0.015560737811028957, 0.252608060836792, 0.020116353407502174, -0.9672343730926514], [0.25484025478363037, 0.25237682461738586, -0.0407620370388031, -0.9325775504112244], [0.4788075387477875, 0.2382688671350479, -0.09688449651002884, -0.8393954634666443], [0.6730226874351501, 0.20872892439365387, -0.14696542918682098, -0.6941713094711304], [0.8245698809623718, 0.1662987768650055, -0.19105088710784912, -0.505893886089325], [0.9238393902778625, 0.11622718721628189, -0.22677911818027496, -0.2856277823448181], [0.9652531743049622, 0.062242817133665085, -0.2494446337223053, -0.04679122567176819], [0.9467708468437195, 0.005019321106374264, -0.2559588551521301, 0.19515325129032135], [0.8693042993545532, -0.054804205894470215, -0.24751241505146027, 0.4243159890174866], [0.7369759678840637, -0.1133202612400055, -0.227430522441864, 0.6263387799263], [0.5578092932701111, -0.16442576050758362, -0.19713769853115082, 0.7892715334892273], [0.3435975909233093, -0.20405994355678558, -0.15564176440238953, 0.9033691883087158], [0.1084393784403801, -0.23213635385036469, -0.1031491830945015, 0.9611002802848816], [-0.13303901255130768, -0.24975672364234924, -0.04381926730275154, 0.9581242799758911], [-0.3664528727531433, -0.25560399889945984, 0.01620386727154255, 0.8944922089576721], [-0.5775513648986816, -0.2464887648820877, 0.07302680611610413, 0.7748190760612488], [-0.7526082396507263, -0.22138458490371704, 0.12604570388793945, 0.6071920990943909], [-0.8799451589584351, -0.18353286385536194, 0.1746232956647873, 0.40189406275749207], [-0.9515823721885681, -0.13774529099464417, 0.2150876224040985, 0.1710391789674759], [-0.9637174010276794, -0.08645018935203552, 0.24229687452316284, -0.0711846873164177], [-0.9160702228546143, -0.02966018207371235, 0.2538608908653259, -0.3090146481990814], [-0.8112840056419373, 0.03128209337592125, 0.25148946046829224, -0.526870608329773], [-0.6551966667175293, 0.0914173424243927, 0.2377464473247528, -0.7112220525741577], [-0.45742735266685486, 0.144630566239357, 0.21263067424297333, -0.8512521982192993], [-0.23101022839546204, 0.18778616189956665, 0.1745864450931549, -0.9385574460029602], [0.009251575917005539, 0.2212095856666565, 0.12452398240566254, -0.9671993255615234], [0.2485300898551941, 0.24506309628486633, 0.06733246892690659, -0.9346888065338135], [0.47259119153022766, 0.25665751099586487, 0.008712065406143665, -0.8430353403091431], [0.667661726474762, 0.25245752930641174, -0.04859829694032669, -0.6986638307571411], [0.8209395408630371, 0.232176274061203, -0.10434836149215698, -0.5111398100852966], [0.9221636652946472, 0.1994803547859192, -0.15692239999771118, -0.29188552498817444], [0.9651011228561401, 0.15834030508995056, -0.2015039026737213, -0.05389019474387169], [0.9477783441543579, 0.1098736897110939, -0.23294605314731598, 0.1880960315465927], [0.8716781139373779, 0.0538029670715332, -0.24969591200351715, 0.41825154423713684], [0.7411352396011353, -0.007602265570312738, -0.2536573112010956, 0.6215454339981079], [0.563620388507843, -0.06858834624290466, -0.24628852307796478, 0.7854741215705872], [0.35020866990089417, -0.1234545186161995, -0.2262624055147171, 0.9005100131034851], [0.11497605592012405, -0.17004558444023132, -0.1918610781431198, 0.9597156643867493], [-0.126798614859581, -0.20873908698558807, -0.14484642446041107, 0.9588376879692078], [-0.3603055775165558, -0.23849260807037354, -0.09051153808832169, 0.8972784876823425], [-0.5716661214828491, -0.2554508447647095, -0.033723246306180954, 0.77897709608078], [-0.747788667678833, -0.25614646077156067, 0.023894548416137695, 0.6120703220367432], [-0.8769933581352234, -0.2411026805639267, 0.08206364512443542, 0.40745264291763306], [-0.9505930542945862, -0.21404141187667847, 0.13801290094852448, 0.17751504480838776], [-0.9641931056976318, -0.17776915431022644, 0.1860795021057129, -0.0640646293759346], [-0.9176746606826782, -0.13223333656787872, 0.22151321172714233, -0.30219119787216187], [-0.8142590522766113, -0.07725746184587479, 0.24358826875686646, -0.5212276577949524], [-0.6599077582359314, -0.016125308349728584, 0.25401192903518677, -0.7069226503372192], [-0.4636179804801941, 0.044981230050325394, 0.2529027760028839, -0.8479830622673035], [-0.23775887489318848, 0.10113704949617386, 0.2378474920988083, -0.9363068342208862], [0.0027673591393977404, 0.15107205510139465, 0.20735347270965576, -0.9665268063545227], [0.24244216084480286, 0.1948235034942627, 0.1640353798866272, -0.9361400008201599], [0.4666922986507416, 0.23001080751419067, 0.11318472772836685, -0.8464528918266296], [0.6621938943862915, 0.2519400715827942, 0.05854257941246033, -0.7032768130302429], [0.8167324662208557, 0.25757676362991333, 0.0008014068589545786, -0.5163348913192749], [0.9199304580688477, 0.24817471206188202, -0.05935269594192505, -0.2976820170879364], [0.964807391166687, 0.22709521651268005, -0.11796196550130844, -0.060493528842926025], [0.9488711357116699, 0.19578085839748383, -0.16890986263751984, 0.18105989694595337], [0.873856782913208, 0.1532793492078781, -0.20816314220428467, 0.4117617607116699], [0.7446718811988831, 0.09987112134695053, -0.23566685616970062, 0.6164013743400574], [0.5688163042068481, 0.03979004546999931, -0.25253036618232727, 0.7817245125770569], [0.3566856384277344, -0.020782457664608955, -0.25743988156318665, 0.8978129029273987], [0.12176146358251572, -0.07794773578643799, -0.24724401533603668, 0.9581068754196167], [-0.1204577386379242, -0.13109079003334045, -0.2209942489862442, 0.9588882923126221], [-0.3544522523880005, -0.17954017221927643, -0.18201051652431488, 0.8994448184967041], [-0.5660988092422485, -0.2195955365896225, -0.13515044748783112, 0.7829714417457581], [-0.742819607257843, -0.2461303472518921, -0.0828704908490181, 0.6170667409896851], [-0.873460590839386, -0.25681060552597046, -0.025231370702385902, 0.41289016604423523], [-0.9491074681282043, -0.25340184569358826, 0.036349792033433914, 0.18346960842609406], [-0.9645933508872986, -0.23849865794181824, 0.09685033559799194, -0.05742887780070305], [-0.9193646311759949, -0.21212902665138245, 0.1501374989748001, -0.29534485936164856], [-0.8169804215431213, -0.17280200123786926, 0.193092480301857, -0.5151675343513489], [-0.6639572978019714, -0.12152411788702011, 0.22605246305465698, -0.7023480534553528], [-0.4692228138446808, -0.06326960027217865, 0.2491724044084549, -0.8448312878608704], [-0.24442355334758759, -0.0037833128590136766, 0.2597689926624298, -0.9342178106307983], [-0.003953416366130114, 0.054172083735466, 0.25436028838157654, -0.9655830264091492], [0.23633305728435516, 0.11030688881874084, 0.23274900019168854, -0.9369134902954102], [0.46115243434906006, 0.16294923424720764, 0.19868217408657074, -0.8493004441261292], [0.6570366621017456, 0.2072492241859436, 0.15618078410625458, -0.7077839374542236], [0.8123352527618408, 0.23807936906814575, 0.10641027987003326, -0.5216382145881653], [0.9171228408813477, 0.2539409399032593, 0.049171388149261475, -0.3032850921154022], [0.9640867710113525, 0.2567835748195648, -0.013168597593903542, -0.06652450561523438], [0.9499531388282776, 0.24809356033802032, -0.07478386163711548, 0.17448744177818298], [0.8761148452758789, 0.22658783197402954, -0.12995094060897827, 0.40520793199539185], [0.747896671295166, 0.1906382441520691, -0.17651686072349548, 0.6108594536781311], [0.5733221173286438, 0.1421208679676056, -0.21484974026679993, 0.7777808308601379], [0.3626164495944977, 0.08642058074474335, -0.24388854205608368, 0.895298421382904], [0.1285114884376526, 0.028457969427108765, -0.2597905993461609, 0.9566523432731628], [-0.11390171945095062, -0.030097072944045067, -0.2591569423675537, 0.9586230516433716], [-0.3486594557762146, -0.08889862149953842, -0.24260713160037994, 0.9009302854537964], [-0.5609468817710876, -0.1451021134853363, -0.2139430046081543, 0.786455512046814], [-0.7381454110145569, -0.19301019608974457, -0.17602860927581787, 0.6220147609710693], [-0.8697001934051514, -0.2278948724269867, -0.1288825124502182, 0.41841933131217957], [-0.9470649361610413, -0.24907803535461426, -0.07243576645851135, 0.18915928900241852], [-0.9646428227424622, -0.2583020329475403, -0.010087834671139717, -0.05140473321080208], [-0.9211053848266602, -0.2557141184806824, 0.051901813596487045, -0.28893136978149414], [-0.8197689056396484, -0.23896394670009613, 0.10857842862606049, -0.5090047717094421], [-0.6676388382911682, -0.20667137205600739, 0.15865592658519745, -0.6974048614501953], [-0.47412076592445374, -0.16157802939414978, 0.20214146375656128, -0.8415703773498535], [-0.25059080123901367, -0.10907170921564102, 0.23662924766540527, -0.9323702454566956], [-0.010683931410312653, -0.05295880511403084, 0.2574480473995209, -0.9647806286811829], [0.23003968596458435, 0.005996925290673971, 0.2616439759731293, -0.937330424785614], [0.4557560384273529, 0.06701530516147614, 0.25056955218315125, -0.8514753580093384], [0.6523426175117493, 0.12605305016040802, 0.22766423225402832, -0.7118487358093262], [0.8082112669944763, 0.17696091532707214, 0.19443906843662262, -0.5269467830657959], [0.9140551090240479, 0.2157277911901474, 0.15003859996795654, -0.3089549243450165]]; // Quaternions
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const cx = canvas.width / 2;
        const cy = canvas.height / 2;
        const scale = 150; 
        
        let frame = 0;
        
        // Trail buffers
        const trail = [];
        const maxTrail = 200;
        
        function rotateByQuat(v, q) {
            const [w, x, y, z] = q;
            const [vx, vy, vz] = v;
            const x2 = x + x, y2 = y + y, z2 = z + z;
            const xx = x * x2, xy = x * y2, xz = x * z2;
            const yy = y * y2, yz = y * z2, zz = z * z2;
            const wx = w * x2, wy = w * y2, wz = w * z2;
            return [
                (1 - (yy + zz)) * vx + (xy - wz) * vy + (xz + wy) * vz,
                (xy + wz) * vx + (1 - (xx + zz)) * vy + (yz - wx) * vz,
                (xz - wy) * vx + (yz + wx) * vy + (1 - (xx + yy)) * vz
            ];
        }
        
        function draw() {
            ctx.fillStyle = 'rgba(0,0,0,0.2)';
            ctx.fillRect(0,0, canvas.width, canvas.height);
            
            const q = history[frame];
            
            // Top Axis in Body is Z [0,0,1] (if symmetric around Z)
            // But usually heavy top is symmetric about Z.
            // Let's project the Tip of the top.
            const tip_body = [0, 0, 1.5]; 
            const tip_space = rotateByQuat(tip_body, q);
            
            // Draw Trail (Projected on XY plane - overhead view)
            trail.push([cx + tip_space[0]*scale, cy - tip_space[1]*scale]);
            if (trail.length > maxTrail) trail.shift();
            
            ctx.strokeStyle = '#0f0';
            ctx.beginPath();
            if(trail.length > 0) ctx.moveTo(trail[0][0], trail[0][1]);
            for(let p of trail) ctx.lineTo(p[0], p[1]);
            ctx.stroke();
            
            // Draw Top "Cone" roughly
            const base_pts = [[0.5,0,0], [-0.5,0,0], [0,0.5,0], [0,-0.5,0]];
            
            ctx.fillStyle = '#ff4444';
            ctx.beginPath();
            const top_tip = [cx + tip_space[0]*scale, cy - tip_space[1]*scale];
            
            // Origin (Pivot)
            const pivot = [cx, cy]; // Origin is fixed in space (lagrange top)
            
            ctx.moveTo(pivot[0], pivot[1]);
            ctx.lineTo(top_tip[0], top_tip[1]);
            ctx.strokeStyle = '#fff';
            ctx.stroke();
            
            // Draw Tip
            ctx.beginPath();
            ctx.arc(top_tip[0], top_tip[1], 5, 0, 2*Math.PI);
            ctx.fill();
            
            frame = (frame + 1) % history.length;
            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>
</html>
    
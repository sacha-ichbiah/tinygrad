
<!DOCTYPE html>
<html>
<head>
    <title>Point Vortices</title>
    <style>
        body { font-family: sans-serif; background: #222; color: #fff; display: flex; flex-direction: column; align-items: center; }
        canvas { border: 1px solid #555; background: #000; }
    </style>
</head>
<body>
    <h1>Point Vortex Dynamics</h1>
    <p>Red = Positive Circulation, Blue = Negative.</p>
    <canvas id="simCanvas" width="600" height="600"></canvas>
    <script>
        const history = [[[0.496459037065506, -0.13758376240730286], [0.6464337110519409, 1.5227389335632324], [-0.2341875284910202, -0.2353617250919342], [1.5782471895217896, 0.7676880359649658]], [[0.49514079093933105, -0.13419419527053833], [0.640156626701355, 1.5212724208831787], [-0.23431359231472015, -0.2414816915988922], [1.5734144449234009, 0.768951952457428]], [[0.49375131726264954, -0.1308269500732422], [0.633874773979187, 1.51978600025177], [-0.2343652993440628, -0.24759463965892792], [1.5685737133026123, 0.7702111601829529]], [[0.49229079484939575, -0.12748269736766815], [0.627588152885437, 1.5182795524597168], [-0.23434282839298248, -0.2536998987197876], [1.5637251138687134, 0.7714656591415405]], [[0.49075940251350403, -0.12416209280490875], [0.6212968230247498, 1.5167529582977295], [-0.2342463731765747, -0.25979673862457275], [1.5588687658309937, 0.7727153897285461]], [[0.48915722966194153, -0.12086579948663712], [0.6150007843971252, 1.5152063369750977], [-0.2340761423110962, -0.26588448882102966], [1.5540046691894531, 0.7739602327346802]], [[0.48748430609703064, -0.11759446561336517], [0.6086999773979187, 1.5136395692825317], [-0.23383231461048126, -0.2719624638557434], [1.549133062362671, 0.7752001285552979]], [[0.4857407808303833, -0.11434870958328247], [0.6023945212364197, 1.5120526552200317], [-0.23351503908634186, -0.2780299782752991], [1.544253945350647, 0.7764349579811096]], [[0.48392677307128906, -0.11112918704748154], [0.596084475517273, 1.510445475578308], [-0.2331244945526123, -0.2840863764286041], [1.539367437362671, 0.7776646614074707]], [[0.4820423722267151, -0.10793651640415192], [0.589769721031189, 1.5088180303573608], [-0.23266084492206573, -0.29013100266456604], [1.5344734191894531, 0.7788891792297363]], [[0.4800876975059509, -0.10477133095264435], [0.583450436592102, 1.50717031955719], [-0.23212426900863647, -0.2961631119251251], [1.5295722484588623, 0.7801084518432617]], [[0.47806277871131897, -0.10163424909114838], [0.577126681804657, 1.5055023431777954], [-0.23151490092277527, -0.3021821081638336], [1.524664044380188, 0.7813223600387573]], [[0.4759677052497864, -0.09852589666843414], [0.570798397064209, 1.5038139820098877], [-0.23083288967609406, -0.3081872761249542], [1.5197486877441406, 0.7825308442115784]], [[0.4738025665283203, -0.09544689208269119], [0.5644654631614685, 1.5021052360534668], [-0.23007839918136597, -0.3141779601573944], [1.5148265361785889, 0.7837337851524353]], [[0.47156739234924316, -0.09239784628152847], [0.558128297328949, 1.5003761053085327], [-0.22925153374671936, -0.32015344500541687], [1.5098975896835327, 0.7849311232566833]], [[0.4692623019218445, -0.08937938511371613], [0.5517866611480713, 1.4986265897750854], [-0.22835244238376617, -0.3261130750179291], [1.5049619674682617, 0.7861226797103882]], [[0.46688729524612427, -0.0863921120762825], [0.5454405546188354, 1.4968565702438354], [-0.22738125920295715, -0.3320561349391937], [1.5000196695327759, 0.7873085141181946]], [[0.4644424021244049, -0.08343664556741714], [0.5390902161598206, 1.4950660467147827], [-0.22633810341358185, -0.3379819393157959], [1.4950709342956543, 0.7884883880615234]], [[0.4619276821613312, -0.0805136039853096], [0.5327355265617371, 1.4932551383972168], [-0.22522306442260742, -0.34388983249664307], [1.490116000175476, 0.7896623015403748]], [[0.45934316515922546, -0.07762360572814941], [0.5263766050338745, 1.491423487663269], [-0.22403627634048462, -0.3497790992259979], [1.4851547479629517, 0.7908300161361694]], [[0.45668888092041016, -0.07476726174354553], [0.5200135111808777, 1.4895715713500977], [-0.2227778136730194, -0.35564905405044556], [1.4801872968673706, 0.7919915318489075]], [[0.45396482944488525, -0.0719451978802681], [0.5136463046073914, 1.4876987934112549], [-0.22144781053066254, -0.36149898171424866], [1.475213885307312, 0.7931467890739441]], [[0.45117104053497314, -0.06915802508592606], [0.5072749853134155, 1.4858057498931885], [-0.22004632651805878, -0.36732813715934753], [1.470234990119934, 0.7942955493927002]], [[0.44830751419067383, -0.06640636920928955], [0.5008995532989502, 1.4838918447494507], [-0.21857348084449768, -0.37313583493232727], [1.4652502536773682, 0.7954378128051758]], [[0.4453742504119873, -0.06369087845087051], [0.4945202171802521, 1.4819574356079102], [-0.21702931821346283, -0.3789213299751282], [1.460260033607483, 0.7965733408927917]], [[0.4423712491989136, -0.06101216748356819], [0.4881369173526764, 1.4800024032592773], [-0.21541395783424377, -0.3846839666366577], [1.4552643299102783, 0.7977021932601929]], [[0.43929848074913025, -0.058370884507894516], [0.4817497432231903, 1.4780265092849731], [-0.2137274444103241, -0.3904229402542114], [1.4502633810043335, 0.7988241314888]], [[0.4361559748649597, -0.05576767399907112], [0.475358784198761, 1.4760303497314453], [-0.21196988224983215, -0.3961374759674072], [1.4452574253082275, 0.7999391555786133]], [[0.4329436719417572, -0.05320318043231964], [0.4689640998840332, 1.474013328552246], [-0.21014130115509033, -0.4018268287181854], [1.4402464628219604, 0.8010470271110535]], [[0.4296616017818451, -0.0506780669093132], [0.46256569027900696, 1.4719756841659546], [-0.2082417756319046, -0.40749025344848633], [1.4352306127548218, 0.802147626876831]], [[0.4263096749782562, -0.04819298908114433], [0.456163614988327, 1.4699175357818604], [-0.20627138018608093, -0.41312694549560547], [1.430209994316101, 0.8032410740852356]], [[0.4228878915309906, -0.04574863240122795], [0.44975796341896057, 1.4678385257720947], [-0.2042301446199417, -0.418736070394516], [1.4251848459243774, 0.8043270111083984]], [[0.4193962514400482, -0.04334566742181778], [0.44334882497787476, 1.4657390117645264], [-0.2021181434392929, -0.4243168830871582], [1.4201552867889404, 0.8054052591323853]], [[0.4158347249031067, -0.04098479077219963], [0.43693622946739197, 1.4636188745498657], [-0.1999354511499405, -0.42986854910850525], [1.4151215553283691, 0.806475818157196]], [[0.41220322251319885, -0.03866669535636902], [0.43052026629447937, 1.4614778757095337], [-0.19768208265304565, -0.4353901445865631], [1.4100837707519531, 0.8075385689735413]], [[0.4085017740726471, -0.036392100155353546], [0.4241010248661041, 1.459316611289978], [-0.19535811245441437, -0.4408809244632721], [1.405042052268982, 0.8085933327674866]], [[0.40473029017448425, -0.03416172042489052], [0.417678564786911, 1.457134485244751], [-0.19296357035636902, -0.4463399350643158], [1.3999966382980347, 0.8096399903297424]], [[0.4008887708187103, -0.03197629377245903], [0.4112529456615448, 1.4549319744110107], [-0.19049853086471558, -0.45176637172698975], [1.3949475288391113, 0.8106783628463745]], [[0.39697715640068054, -0.029836561530828476], [0.40482428669929504, 1.4527087211608887], [-0.18796302378177643, -0.4571593105792999], [1.3898948431015015, 0.8117084503173828]], [[0.3929954171180725, -0.02774328924715519], [0.3983926475048065, 1.4504650831222534], [-0.18535710871219635, -0.4625178575515747], [1.3848391771316528, 0.8127299547195435]], [[0.38894355297088623, -0.025697246193885803], [0.3919580578804016, 1.4482008218765259], [-0.1826808750629425, -0.4678409993648529], [1.3797801733016968, 0.8137428760528564]], [[0.3848215341567993, -0.023699220269918442], [0.38552066683769226, 1.4459161758422852], [-0.1799343377351761, -0.4731278419494629], [1.3747183084487915, 0.8147469162940979]], [[0.3806293308734894, -0.021750014275312424], [0.37908053398132324, 1.4436110258102417], [-0.17711757123470306, -0.47837743163108826], [1.3696537017822266, 0.815742015838623]], [[0.37636691331863403, -0.019850440323352814], [0.3726377487182617, 1.4412853717803955], [-0.1742306500673294, -0.48358872532844543], [1.364586353302002, 0.8167281746864319]], [[0.37203431129455566, -0.018001334741711617], [0.36619240045547485, 1.4389393329620361], [-0.17127366364002228, -0.48876070976257324], [1.3595166206359863, 0.8177050948143005]], [[0.3676314949989319, -0.01620355062186718], [0.3597445785999298, 1.4365730285644531], [-0.16824664175510406, -0.4938923716545105], [1.3544446229934692, 0.8186726570129395]], [[0.3631584644317627, -0.014457952231168747], [0.35329440236091614, 1.4341864585876465], [-0.16514968872070312, -0.498982697725296], [1.3493704795837402, 0.8196307420730591]], [[0.3586152493953705, -0.012765425257384777], [0.3468419015407562, 1.4317795038223267], [-0.161982923746109, -0.5040305852890015], [1.3442944288253784, 0.8205791115760803]], [[0.35400187969207764, -0.011126874014735222], [0.3403872549533844, 1.4293524026870728], [-0.1587464064359665, -0.5090348720550537], [1.3392165899276733, 0.8215177655220032]], [[0.3493184447288513, -0.00954322051256895], [0.33393052220344543, 1.4269051551818848], [-0.1554403007030487, -0.5139944553375244], [1.334137201309204, 0.8224464654922485]], [[0.3445649743080139, -0.008015405386686325], [0.3274718225002289, 1.4244377613067627], [-0.15206469595432281, -0.5189082026481628], [1.3290563821792603, 0.8233650326728821]], [[0.3397414982318878, -0.006544393487274647], [0.3210112452507019, 1.421950340270996], [-0.14861977100372314, -0.5237749218940735], [1.323974370956421, 0.824273407459259]], [[0.33484816551208496, -0.005131164565682411], [0.31454890966415405, 1.4194430112838745], [-0.14510564506053925, -0.5285935401916504], [1.3188912868499756, 0.8251713514328003]], [[0.3298850357532501, -0.00377672235481441], [0.3080849349498749, 1.4169156551361084], [-0.14152251183986664, -0.5333626866340637], [1.3138072490692139, 0.8260586857795715]], [[0.32485225796699524, -0.002482091076672077], [0.3016194701194763, 1.4143685102462769], [-0.13787052035331726, -0.5380811095237732], [1.3087224960327148, 0.8269352912902832]], [[0.31974998116493225, -0.0012483167229220271], [0.2951525151729584, 1.4118015766143799], [-0.1341499239206314, -0.5427476167678833], [1.303637146949768, 0.8278010487556458]], [[0.3145783841609955, -7.646610902156681e-05], [0.28868427872657776, 1.4092148542404175], [-0.1303609013557434, -0.547360897064209], [1.2985515594482422, 0.8286557197570801]], [[0.30933770537376404, 0.0010323711903765798], [0.28221482038497925, 1.4066084623336792], [-0.12650372087955475, -0.5519194602966309], [1.293465495109558, 0.8294991850852966]], [[0.30402812361717224, 0.0020770845003426075], [0.27574434876441956, 1.4039826393127441], [-0.12257867306470871, -0.5564221739768982], [1.288379430770874, 0.8303313851356506]], [[0.2986498773097992, 0.003056539222598076], [0.26927292346954346, 1.4013372659683228], [-0.11858604103326797, -0.5608674883842468], [1.2832934856414795, 0.8311520218849182]], [[0.29320332407951355, 0.0039695799350738525], [0.26280075311660767, 1.3986724615097046], [-0.11452615261077881, -0.5652540922164917], [1.2782080173492432, 0.8319608569145203]], [[0.2876887321472168, 0.004815028049051762], [0.25632786750793457, 1.3959884643554688], [-0.11039936542510986, -0.569580614566803], [1.2731229066848755, 0.8327580094337463]], [[0.28210651874542236, 0.005591683089733124], [0.2498544603586197, 1.3932852745056152], [-0.10620608180761337, -0.5738455653190613], [1.2680383920669556, 0.8335430026054382]], [[0.2764570415019989, 0.006298321299254894], [0.24338066577911377, 1.3905630111694336], [-0.10194668918848038, -0.5780473351478577], [1.2629547119140625, 0.8343158960342407]], [[0.2707407772541046, 0.006933698896318674], [0.23690661787986755, 1.3878216743469238], [-0.09762166440486908, -0.5821844935417175], [1.2578718662261963, 0.8350764513015747]], [[0.2649582028388977, 0.007496550679206848], [0.23043251037597656, 1.3850613832473755], [-0.09323149919509888, -0.5862554907798767], [1.2527902126312256, 0.8358244299888611]], [[0.25910982489585876, 0.007985590025782585], [0.22395843267440796, 1.3822823762893677], [-0.08877671509981155, -0.5902588367462158], [1.2477096319198608, 0.8365597128868103]], [[0.2531962990760803, 0.008399510756134987], [0.21748456358909607, 1.3794846534729004], [-0.08425789326429367, -0.5941929221153259], [1.2426306009292603, 0.8372822403907776]], [[0.24721820652484894, 0.008736985735595226], [0.21101106703281403, 1.3766684532165527], [-0.07967566698789597, -0.5980561375617981], [1.2375530004501343, 0.8379917144775391]], [[0.24117620289325714, 0.00899666827172041], [0.20453809201717377, 1.3738336563110352], [-0.07503068447113037, -0.6018468737602234], [1.232477068901062, 0.8386878967285156]], [[0.2350710928440094, 0.009177196770906448], [0.19806580245494843, 1.3709805011749268], [-0.07032367587089539, -0.6055634021759033], [1.227402925491333, 0.8393706679344177]], [[0.228903666138649, 0.009277194738388062], [0.19159437716007233, 1.3681092262268066], [-0.0655553936958313, -0.609204113483429], [1.2223305702209473, 0.8400400280952454]], [[0.22267477214336395, 0.009295265190303326], [0.1851239949464798, 1.3652195930480957], [-0.06072665750980377, -0.6127673387527466], [1.2172603607177734, 0.8406957387924194]], [[0.2163853496313095, 0.009230000898241997], [0.17865481972694397, 1.3623120784759521], [-0.05583834648132324, -0.6162514090538025], [1.2121922969818115, 0.8413375616073608]], [[0.21003639698028564, 0.009079980663955212], [0.17218704521656036, 1.359386682510376], [-0.05089139938354492, -0.6196544766426086], [1.207126498222351, 0.8419652581214905]], [[0.2036290168762207, 0.008843773975968361], [0.1657208502292633, 1.3564434051513672], [-0.0458868034183979, -0.6229749917984009], [1.2020630836486816, 0.8425788283348083]], [[0.19716429710388184, 0.008519941009581089], [0.15925642848014832, 1.353482723236084], [-0.04082562401890755, -0.6262111663818359], [1.1970021724700928, 0.8431780338287354]], [[0.19064350426197052, 0.008107036352157593], [0.15279395878314972, 1.3505043983459473], [-0.03570897877216339, -0.6293612122535706], [1.191943883895874, 0.8437626957893372]], [[0.18406790494918823, 0.0076036108657717705], [0.14633364975452423, 1.3475086688995361], [-0.030538057908415794, -0.632423460483551], [1.1868882179260254, 0.8443326950073242]], [[0.1774388700723648, 0.007008212152868509], [0.13987571001052856, 1.3444957733154297], [-0.025314120575785637, -0.6353961229324341], [1.1818355321884155, 0.844887912273407]], [[0.17075785994529724, 0.006319390144199133], [0.13342033326625824, 1.341465711593628], [-0.02003849670290947, -0.6382774114608765], [1.1767855882644653, 0.845427930355072]], [[0.1640264391899109, 0.005535698961466551], [0.12696774303913116, 1.3384184837341309], [-0.014712588861584663, -0.6410657167434692], [1.1717382669448853, 0.8459528088569641]], [[0.1572462022304535, 0.00465569831430912], [0.12051816284656525, 1.3353544473648071], [-0.009337873198091984, -0.6437591910362244], [1.166693925857544, 0.8464623093605042]], [[0.15041887760162354, 0.0036779583897441626], [0.11407177895307541, 1.3322736024856567], [-0.003915906883776188, -0.6463562846183777], [1.1616531610488892, 0.8469563126564026]], [[0.14354626834392548, 0.0026010642759501934], [0.10762884467840195, 1.3291760683059692], [0.0015516778221353889, -0.6488552093505859], [1.1566153764724731, 0.8474346399307251]], [[0.13663026690483093, 0.001423617242835462], [0.10118957608938217, 1.3260620832443237], [0.007063169497996569, -0.6512542963027954], [1.151580572128296, 0.8478971123695374]], [[0.1296728551387787, 0.0001442394859623164], [0.09475420415401459, 1.3229315280914307], [0.0126167768612504, -0.6535518765449524], [1.146548867225647, 0.8483436107635498]], [[0.12267613410949707, -0.0012384217698127031], [0.0883229598402977, 1.3197848796844482], [0.018210629001259804, -0.6557464003562927], [1.141520619392395, 0.8487739562988281]], [[0.11564226448535919, -0.0027256899047642946], [0.0818960964679718, 1.3166218996047974], [0.023842768743634224, -0.6578360795974731], [1.1364953517913818, 0.8491879105567932]], [[0.10857350379228592, -0.004318855237215757], [0.0754738375544548, 1.3134428262710571], [0.029511168599128723, -0.6598196029663086], [1.1314735412597656, 0.8495854735374451]], [[0.10147222131490707, -0.006019170396029949], [0.0690564438700676, 1.310247778892517], [0.03521370515227318, -0.6616953015327454], [1.1264548301696777, 0.8499664664268494]], [[0.09434088319540024, -0.007827847264707088], [0.06264416128396988, 1.3070368766784668], [0.04094818979501724, -0.6634618639945984], [1.1214394569396973, 0.8503307700157166]], [[0.08718201518058777, -0.009746047668159008], [0.056237246841192245, 1.3038101196289062], [0.04671233519911766, -0.6651178598403931], [1.1164273023605347, 0.8506781458854675]], [[0.07999826967716217, -0.011774887330830097], [0.04983595386147499, 1.3005677461624146], [0.052503783255815506, -0.66666179895401], [1.1114181280136108, 0.8510085344314575]], [[0.07279236614704132, -0.01391542237251997], [0.04344053938984871, 1.2973096370697021], [0.05832010507583618, -0.6680924892425537], [1.1064125299453735, 0.8513217568397522]], [[0.06556710600852966, -0.01616865023970604], [0.03705126792192459, 1.2940360307693481], [0.06415878236293793, -0.6694087982177734], [1.101409912109375, 0.851617693901062]], [[0.05832540616393089, -0.018535500392317772], [0.030668405815958977, 1.290747046470642], [0.07001723349094391, -0.6706095337867737], [1.0964102745056152, 0.8518962264060974]], [[0.05107023939490318, -0.021016834303736687], [0.024292215704917908, 1.2874425649642944], [0.07589279860258102, -0.6716936230659485], [1.0914136171340942, 0.8521572351455688]], [[0.043804679065942764, -0.023613443598151207], [0.017922963947057724, 1.2841227054595947], [0.0817827507853508, -0.6726601123809814], [1.086419939994812, 0.8524006009101868]], [[0.03653185814619064, -0.026326030492782593], [0.011560925282537937, 1.280787706375122], [0.0876842811703682, -0.6735081672668457], [1.0814292430877686, 0.8526262044906616]], [[0.029254989698529243, -0.029155222699046135], [0.0052063679322600365, 1.2774373292922974], [0.09359455108642578, -0.6742369532585144], [1.0764414072036743, 0.8528339266777039]], [[0.021977348253130913, -0.032101552933454514], [-0.001140436390414834, 1.2740719318389893], [0.09951063990592957, -0.6748457551002502], [1.0714560747146606, 0.8530235886573792]], [[0.01470228098332882, -0.03516547009348869], [-0.007479215506464243, 1.270691156387329], [0.10542957484722137, -0.6753339171409607], [1.0664734840393066, 0.8531951308250427]], [[0.007433186285197735, -0.03834732249379158], [-0.013809697702527046, 1.267295479774475], [0.11134833842515945, -0.6757012009620667], [1.0614933967590332, 0.8533484935760498]], [[0.00017351668793708086, -0.04164735972881317], [-0.020131610333919525, 1.2638845443725586], [0.11726386845111847, -0.6759471297264099], [1.0565155744552612, 0.8534834980964661]], [[-0.007073228247463703, -0.04506572335958481], [-0.026444680988788605, 1.2604584693908691], [0.1231730580329895, -0.6760714054107666], [1.0515400171279907, 0.8536001443862915]], [[-0.014303509145975113, -0.04860245808959007], [-0.032748639583587646, 1.2570174932479858], [0.12907278537750244, -0.6760739088058472], [1.0465666055679321, 0.8536982536315918]], [[-0.02151375450193882, -0.05225749686360359], [-0.03904321789741516, 1.2535611391067505], [0.134959876537323, -0.6759546399116516], [1.041595220565796, 0.8537777662277222]], [[-0.028700366616249084, -0.05603065341711044], [-0.04532814770936966, 1.2500897645950317], [0.1408311426639557, -0.6757137775421143], [1.036625623703003, 0.8538386225700378]], [[-0.03585972264409065, -0.05992164835333824], [-0.05160316824913025, 1.24660325050354], [0.14668338000774384, -0.6753515005111694], [1.0316576957702637, 0.853880763053894]], [[-0.042988188564777374, -0.06393006443977356], [-0.05786801129579544, 1.2431014776229858], [0.15251338481903076, -0.674868106842041], [1.0266913175582886, 0.853904128074646]], [[-0.05008213222026825, -0.06805536895990372], [-0.06412241607904434, 1.2395844459533691], [0.1583179533481598, -0.6742641925811768], [1.0217262506484985, 0.8539085984230042]], [[-0.05713791400194168, -0.07229695469141006], [-0.07036612927913666, 1.23605215549469], [0.16409388184547424, -0.6735404133796692], [1.016762375831604, 0.8538941144943237]], [[-0.06415192037820816, -0.07665403187274933], [-0.0765988901257515, 1.2325044870376587], [0.16983798146247864, -0.6726974248886108], [1.0117994546890259, 0.85386061668396]], [[-0.07112053036689758, -0.08112574368715286], [-0.08282045274972916, 1.2289413213729858], [0.1755470633506775, -0.6717362999916077], [1.0068374872207642, 0.8538080453872681]], [[-0.07804016768932343, -0.08571108430624008], [-0.08903058618307114, 1.225362777709961], [0.1812179684638977, -0.6706578731536865], [1.0018759965896606, 0.8537363409996033]], [[-0.08490727841854095, -0.09040898084640503], [-0.09522904455661774, 1.2217684984207153], [0.18684759736061096, -0.6694633364677429], [0.9969151020050049, 0.8536454439163208]], [[-0.09171835333108902, -0.09521817415952682], [-0.10141558200120926, 1.2181586027145386], [0.19243288040161133, -0.6681540012359619], [0.9919543862342834, 0.8535354733467102]], [[-0.09846994280815125, -0.10013735294342041], [-0.10758998245000839, 1.2145328521728516], [0.19797076284885406, -0.6667312979698181], [0.9869937300682068, 0.8534061312675476]], [[-0.10515862703323364, -0.10516506433486938], [-0.11375202238559723, 1.2108912467956543], [0.20345830917358398, -0.6651966571807861], [0.982032835483551, 0.8532576560974121]]];
        const gammas = [1.0, -1.0, 1.0, 1.0];
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const cx = canvas.width / 2;
        const cy = canvas.height / 2;
        const scale = 100; 
        
        let frame = 0;
        
        // Trail
        const trails = gammas.map(() => []);
        const maxTrail = 100;
        
        function draw() {
            // Fade out
            ctx.fillStyle = 'rgba(0,0,0,0.2)';
            ctx.fillRect(0,0, canvas.width, canvas.height);
            
            const positions = history[frame];
            
            for(let i=0; i<gammas.length; i++) {
                const x = cx + positions[i][0] * scale;
                const y = cy - positions[i][1] * scale;
                
                // Trail
                trails[i].push([x,y]);
                if(trails[i].length > maxTrail) trails[i].shift();
                
                ctx.beginPath();
                ctx.strokeStyle = gammas[i] > 0 ? 'rgba(255,100,100,0.5)' : 'rgba(100,100,255,0.5)';
                if(trails[i].length > 0) ctx.moveTo(trails[i][0][0], trails[i][0][1]);
                for(let p of trails[i]) ctx.lineTo(p[0], p[1]);
                ctx.stroke();
                
                // Vortex
                ctx.beginPath();
                ctx.arc(x, y, 6, 0, 2*Math.PI);
                ctx.fillStyle = gammas[i] > 0 ? '#f55' : '#55f';
                ctx.fill();
            }
            
            frame = (frame + 1) % history.length;
            requestAnimationFrame(draw);
        }
        
        draw();
    </script>
</body>
</html>
    
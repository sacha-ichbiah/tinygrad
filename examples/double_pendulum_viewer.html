
<!DOCTYPE html>
<html>
<head>
    <title>Double Pendulum - TinyPhysics</title>
    <style>
        body {
            font-family: monospace;
            background: #111;
            color: #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas { border: 1px solid #333; background: #000; }
        .info {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 5px;
            margin: 10px;
            max-width: 500px;
        }
        code { color: #4f4; }
    </style>
</head>
<body>
    <h1>Double Pendulum - Physics Compiled from Energy</h1>
    <div class="info">
        <p>Define ONLY the Hamiltonian:</p>
        <code>H = 0.5 * p^T * M(q)^-1 * p + V(q)</code>
        <p>Non-separable system - autograd handles complex derivatives!</p>
    </div>
    <canvas id="simCanvas" width="600" height="600"></canvas>
    <script>
        const history = [[1.5707963705062866, 0.0], [1.5217385292053223, 0.0012028005439788103], [1.3740044832229614, 0.019292183220386505], [1.121133804321289, 0.09913232177495956], [0.7289643883705139, 0.32775986194610596], [0.19796507060527802, 0.7051863074302673], [-0.24892345070838928, 0.8551401495933533], [-0.6069650650024414, 0.7517277002334595], [-0.8655868768692017, 0.46448829770088196], [-0.9751008152961731, 0.056483667343854904], [-0.8837339282035828, -0.47065067291259766], [-0.613256573677063, -1.113613486289978], [-0.41237446665763855, -1.5956933498382568], [-0.27475419640541077, -1.9272414445877075], [-0.1453755497932434, -2.148331642150879], [0.006938008591532707, -2.2590932846069336], [0.19453564286231995, -2.249016761779785], [0.4069176912307739, -2.1171209812164307], [0.6123878955841064, -1.8804723024368286], [0.7676206231117249, -1.56926429271698], [0.8294995427131653, -1.2139047384262085], [0.7655159831047058, -0.8191013932228088], [0.5360325574874878, -0.323645681142807], [0.05879642069339752, 0.42995166778564453], [-0.30546122789382935, 1.016807198524475], [-0.5044921040534973, 1.3970311880111694], [-0.6179541349411011, 1.6811906099319458], [-0.6713989973068237, 1.9009500741958618], [-0.6752569079399109, 2.0685553550720215], [-0.634796142578125, 2.190333843231201], [-0.5561155080795288, 2.2671098709106445], [-0.45033812522888184, 2.291212558746338], [-0.33320844173431396, 2.246680974960327], [-0.21707458794116974, 2.1171374320983887], [-0.0992339625954628, 1.8945637941360474], [0.043473586440086365, 1.572148084640503], [0.2618870139122009, 1.1115829944610596], [0.6367576718330383, 0.40976834297180176], [0.886145830154419, -0.2143763154745102], [0.9008741974830627, -0.6859551072120667], [0.7457629442214966, -1.0830652713775635], [0.47845974564552307, -1.3726202249526978], [0.1645858734846115, -1.4948252439498901], [-0.16198161244392395, -1.4185701608657837], [-0.5273416638374329, -1.121962547302246], [-0.9618886113166809, -0.6094134449958801], [-1.2454982995986938, -0.20019863545894623], [-1.3571999073028564, 0.1060730591416359], [-1.3298152685165405, 0.38012707233428955], [-1.1761103868484497, 0.6227585077285767], [-0.9190310835838318, 0.7867862582206726], [-0.5859670042991638, 0.8034857511520386], [-0.16690902411937714, 0.5968940854072571], [0.4045352637767792, 0.09083184599876404], [0.8625780940055847, -0.27463498711586], [1.1677675247192383, -0.4222881495952606], [1.3767755031585693, -0.46362313628196716], [1.4950324296951294, -0.45720481872558594], [1.5180186033248901, -0.4361250400543213], [1.444244146347046, -0.4069973826408386], [1.2759156227111816, -0.34878218173980713], [1.009531021118164, -0.21285544335842133], [0.604112982749939, 0.09621985256671906], [0.03614768758416176, 0.608808159828186], [-0.4104315936565399, 0.8637874722480774], [-0.7656897306442261, 0.8679523468017578], [-1.0499705076217651, 0.6984179019927979], [-1.2318923473358154, 0.4263140559196472], [-1.2794158458709717, 0.10680706053972244], [-1.1718297004699707, -0.2590864300727844], [-0.8678874373435974, -0.7529860138893127], [-0.46779927611351013, -1.2724838256835938], [-0.15086600184440613, -1.5608772039413452], [0.14342965185642242, -1.6560269594192505], [0.4402576982975006, -1.567999005317688], [0.7133915424346924, -1.3163304328918457], [0.902046799659729, -0.9547927379608154], [0.948242723941803, -0.5332013964653015], [0.8072731494903564, -0.03160489723086357], [0.4148220717906952, 0.6786972880363464], [0.06985041499137878, 1.2682582139968872], [-0.14029435813426971, 1.6418476104736328], [-0.2999788522720337, 1.8919599056243896], [-0.44250112771987915, 2.0395395755767822], [-0.574936032295227, 2.09549880027771], [-0.6864179968833923, 2.0778615474700928], [-0.761132538318634, 2.0049047470092773], [-0.7878673076629639, 1.8862262964248657], [-0.7609239816665649, 1.721699595451355], [-0.6759787201881409, 1.503122329711914], [-0.5225843787193298, 1.2118701934814453], [-0.26698851585388184, 0.7988649010658264], [0.19558130204677582, 0.11338721215724945], [0.614085853099823, -0.5390134453773499], [0.8081687688827515, -0.9639817476272583], [0.865269660949707, -1.3132480382919312], [0.8126577138900757, -1.6269603967666626], [0.6765184998512268, -1.8992655277252197], [0.49097731709480286, -2.105510711669922], [0.2916874587535858, -2.218846559524536], [0.10781003534793854, -2.2191693782806396]];
        const l1 = 1.0 * 100;
        const l2 = 1.0 * 100;
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const cx = canvas.width / 2;
        const cy = canvas.height / 3;

        let frame = 0;

        function draw() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const angles = history[frame];
            const t1 = angles[0];
            const t2 = angles[1];

            const x1 = cx + l1 * Math.sin(t1);
            const y1 = cy + l1 * Math.cos(t1);
            const x2 = x1 + l2 * Math.sin(t2);
            const y2 = y1 + l2 * Math.cos(t2);

            // Rods
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(cx, cy);
            ctx.lineTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();

            // Masses
            ctx.fillStyle = '#f00';
            ctx.beginPath();
            ctx.arc(x1, y1, 8, 0, 2*Math.PI);
            ctx.fill();

            ctx.fillStyle = '#0f0';
            ctx.beginPath();
            ctx.arc(x2, y2, 8, 0, 2*Math.PI);
            ctx.fill();

            frame = (frame + 1) % history.length;
            requestAnimationFrame(draw);
        }

        draw();
    </script>
</body>
</html>
    

<!DOCTYPE html>
<html>
<head>
    <title>Double Pendulum - TinyPhysics</title>
    <style>
        body {
            font-family: monospace;
            background: #111;
            color: #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas { border: 1px solid #333; background: #000; }
        .info {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 5px;
            margin: 10px;
            max-width: 500px;
        }
        code { color: #4f4; }
    </style>
</head>
<body>
    <h1>Double Pendulum - Physics Compiled from Energy</h1>
    <div class="info">
        <p>Define ONLY the Hamiltonian:</p>
        <code>H = 0.5 * p^T * M(q)^-1 * p + V(q)</code>
        <p>Non-separable system - autograd handles complex derivatives!</p>
    </div>
    <canvas id="simCanvas" width="600" height="600"></canvas>
    <script>
        const history = [[1.5707963705062866, 0.0], [1.5217385292053223, 0.0012028026394546032], [1.3740044832229614, 0.019292190670967102], [1.1211336851119995, 0.09913235157728195], [0.7289641499519348, 0.32775992155075073], [0.1979658156633377, 0.7051849365234375], [-0.24892285466194153, 0.8551393747329712], [-0.6069644689559937, 0.7517275214195251], [-0.8655863404273987, 0.4644888639450073], [-0.9751008152961731, 0.05648494139313698], [-0.8837348818778992, -0.47064849734306335], [-0.6132584810256958, -1.1136101484298706], [-0.41237562894821167, -1.5956909656524658], [-0.27475491166114807, -1.9272395372390747], [-0.14537601172924042, -2.148329734802246], [0.006937738507986069, -2.25909161567688], [0.19453555345535278, -2.2490153312683105], [0.4069177210330963, -2.117119312286377], [0.612388014793396, -1.8804705142974854], [0.7676207423210144, -1.569262146949768], [0.8294994235038757, -1.213902235031128], [0.7655155062675476, -0.8190982341766357], [0.5360312461853027, -0.32364171743392944], [0.05880023539066315, 0.4299478530883789], [-0.3054582178592682, 1.0168040990829468], [-0.5044898986816406, 1.3970285654067993], [-0.6179527044296265, 1.6811879873275757], [-0.671398401260376, 1.900946855545044], [-0.6752575039863586, 2.0685510635375977], [-0.6347979307174683, 2.190328598022461], [-0.5561185479164124, 2.2671029567718506], [-0.4503423571586609, 2.291203260421753], [-0.33321353793144226, 2.246669292449951], [-0.21707980334758759, 2.1171233654022217], [-0.09923809766769409, 1.8945467472076416], [0.0434722825884819, 1.5721275806427002], [0.26189184188842773, 1.111555814743042], [0.6367663741111755, 0.40973716974258423], [0.8861470222473145, -0.21439868211746216], [0.9008712768554688, -0.6859737634658813], [0.745758056640625, -1.0830813646316528], [0.4784548282623291, -1.3726335763931274], [0.1645825207233429, -1.4948363304138184], [-0.16198228299617767, -1.4185799360275269], [-0.5273383259773254, -1.1219732761383057], [-0.9618812799453735, -0.6094259023666382], [-1.2454919815063477, -0.200204998254776], [-1.357192873954773, 0.10607104003429413], [-1.3298066854476929, 0.38012826442718506], [-1.1760996580123901, 0.6227613687515259], [-0.9190184473991394, 0.786788821220398], [-0.5859524607658386, 0.8034859299659729], [-0.16689151525497437, 0.5968891978263855], [0.4045511782169342, 0.09082932770252228], [0.8625891208648682, -0.2746305763721466], [1.1677753925323486, -0.4222812056541443], [1.376780390739441, -0.46361595392227173], [1.4950339794158936, -0.4571989178657532], [1.5180168151855469, -0.4361209273338318], [1.4442390203475952, -0.4069947600364685], [1.275907278060913, -0.34877967834472656], [1.0095192193984985, -0.21285079419612885], [0.6040955781936646, 0.09623077511787415], [0.03613251447677612, 0.6088135838508606], [-0.4104434847831726, 0.8637850880622864], [-0.7656995058059692, 0.8679449558258057], [-1.049977421760559, 0.6984078288078308], [-1.2318954467773438, 0.4263034462928772], [-1.2794148921966553, 0.1067967489361763], [-1.171824336051941, -0.25909748673439026], [-0.8678774833679199, -0.7529994249343872], [-0.4677920639514923, -1.2724899053573608], [-0.15085971355438232, -1.5608776807785034], [0.143435999751091, -1.656022548675537], [0.44026368856430054, -1.5679899454116821], [0.7133955359458923, -1.3163176774978638], [0.902046799659729, -0.9547777771949768], [0.9482372403144836, -0.5331844091415405], [0.8072600364685059, -0.03158224746584892], [0.41480591893196106, 0.6787221431732178], [0.0698428601026535, 1.268272042274475], [-0.14029797911643982, 1.6418572664260864], [-0.29997992515563965, 1.8919671773910522], [-0.44250014424324036, 2.0395452976226807], [-0.5749331116676331, 2.095503807067871], [-0.6864132881164551, 2.0778658390045166], [-0.7611264586448669, 2.0049080848693848], [-0.7878603339195251, 1.8862282037734985], [-0.760916531085968, 1.7216999530792236], [-0.675971269607544, 1.5031206607818604], [-0.5225765109062195, 1.2118659019470215], [-0.2669791281223297, 0.7988567352294922], [0.19558946788311005, 0.11337922513484955], [0.6140875816345215, -0.5390151739120483], [0.8081676363945007, -0.9639835953712463], [0.8652655482292175, -1.31325101852417], [0.8126505017280579, -1.6269643306732178], [0.6765090227127075, -1.8992688655853271], [0.4909667670726776, -2.1055121421813965], [0.2916773557662964, -2.218844413757324], [0.10780133306980133, -2.2191624641418457]];
        const l1 = 1.0 * 100;
        const l2 = 1.0 * 100;
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const cx = canvas.width / 2;
        const cy = canvas.height / 3;

        let frame = 0;

        function draw() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const angles = history[frame];
            const t1 = angles[0];
            const t2 = angles[1];

            const x1 = cx + l1 * Math.sin(t1);
            const y1 = cy + l1 * Math.cos(t1);
            const x2 = x1 + l2 * Math.sin(t2);
            const y2 = y1 + l2 * Math.cos(t2);

            // Rods
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(cx, cy);
            ctx.lineTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();

            // Masses
            ctx.fillStyle = '#f00';
            ctx.beginPath();
            ctx.arc(x1, y1, 8, 0, 2*Math.PI);
            ctx.fill();

            ctx.fillStyle = '#0f0';
            ctx.beginPath();
            ctx.arc(x2, y2, 8, 0, 2*Math.PI);
            ctx.fill();

            frame = (frame + 1) % history.length;
            requestAnimationFrame(draw);
        }

        draw();
    </script>
</body>
</html>
    